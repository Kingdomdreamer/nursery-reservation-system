(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[496],{5496:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var s=n(7437),a=n(2265),i=n(2141),l=n(9703),r=n(5566);class c{static async sendReservationConfirmation(e){try{var t,n,s,a,l;let{data:r,error:c}=await i.O.from("reservations").select("\n          *,\n          customer:customers(*),\n          reservation_items(\n            *,\n            product:products(*)\n          )\n        ").eq("id",e).single();if(c||!r)throw Error("予約データが見つかりません");let o={customerId:r.customer_id,name:(null===(t=r.customer)||void 0===t?void 0:t.full_name)||"顧客",phone:null===(n=r.customer)||void 0===n?void 0:n.phone,email:null===(s=r.customer)||void 0===s?void 0:s.email,lineUserId:null===(a=r.customer)||void 0===a?void 0:a.line_user_id},d={subject:"【予約確定】".concat(r.reservation_number),message:this.generateConfirmationMessage(r),templateData:{reservationNumber:r.reservation_number,customerName:o.name,reservationDate:r.reservation_date,pickupTime:"".concat(r.pickup_time_start||""," - ").concat(r.pickup_time_end||"").trim(),totalAmount:r.final_amount,items:(null===(l=r.reservation_items)||void 0===l?void 0:l.map(e=>{var t;return{name:null===(t=e.product)||void 0===t?void 0:t.name,quantity:e.quantity,price:e.unit_price}}))||[]}},m=await this.sendMultiChannelNotification(o,d);return await this.logNotificationSent(e,"confirmation",m),{success:Object.values(m).some(e=>e.success),results:m}}catch(e){return{success:!1,results:{}}}}static async sendPickupReminder(e){try{var t,n,s,a;let{data:l,error:r}=await i.O.from("reservations").select("\n          *,\n          customer:customers(*)\n        ").eq("id",e).single();if(r||!l)throw Error("予約データが見つかりません");let c={customerId:l.customer_id,name:(null===(t=l.customer)||void 0===t?void 0:t.full_name)||"顧客",phone:null===(n=l.customer)||void 0===n?void 0:n.phone,email:null===(s=l.customer)||void 0===s?void 0:s.email,lineUserId:null===(a=l.customer)||void 0===a?void 0:a.line_user_id},o={subject:"【受取リマインダー】".concat(l.reservation_number),message:this.generateReminderMessage(l),templateData:{reservationNumber:l.reservation_number,customerName:c.name,reservationDate:l.reservation_date,pickupTime:"".concat(l.pickup_time_start||""," - ").concat(l.pickup_time_end||"").trim()}},d=await this.sendMultiChannelNotification(c,o);return await i.O.from("reservations").update({reminder_sent_at:new Date().toISOString()}).eq("id",e),await this.logNotificationSent(e,"reminder",d),{success:Object.values(d).some(e=>e.success),results:d}}catch(e){return{success:!1,results:{}}}}static async sendMultiChannelNotification(e,t){let n={};return this.config.lineEnabled&&e.lineUserId&&(n.line=await this.sendLineMessage(e.lineUserId,t)),this.config.emailEnabled&&e.email&&(n.email=await this.sendEmail(e.email,t)),this.config.smsEnabled&&e.phone&&(n.sms=await this.sendSMS(e.phone,t)),n}static async sendLineMessage(e,t){try{if(!this.config.lineAccessToken)return{success:!1,error:"LINE Access Token が設定されていません"};let n=await fetch("https://api.line.me/v2/bot/message/push",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.config.lineAccessToken)},body:JSON.stringify({to:e,messages:[{type:"text",text:t.message}]})});if(!n.ok){let e=await n.text();return{success:!1,error:"LINE API Error: ".concat(e)}}return{success:!0}}catch(e){return{success:!1,error:e.message}}}static async sendEmail(e,t){try{return{success:!0}}catch(e){return{success:!1,error:e.message}}}static async sendSMS(e,t){try{return{success:!0}}catch(e){return{success:!1,error:e.message}}}static async logNotificationSent(e,t,n){}static generateConfirmationMessage(e){var t,n;let s=(null===(t=e.reservation_items)||void 0===t?void 0:t.map(e=>{var t;return"・".concat(null===(t=e.product)||void 0===t?void 0:t.name," \xd7 ").concat(e.quantity,"個")}).join("\n"))||"";return"【予約確定のお知らせ】\n\n".concat(null===(n=e.customer)||void 0===n?void 0:n.full_name," 様\n\nご予約いただきありがとうございます。\n以下の内容で予約が確定いたしました。\n\n■予約番号: ").concat(e.reservation_number,"\n■受取日: ").concat(new Date(e.reservation_date).toLocaleDateString(),"\n■受取時間: ").concat(e.pickup_time_start||""," - ").concat(e.pickup_time_end||"","\n\n■ご注文内容:\n").concat(s,"\n\n■合計金額: \xa5").concat(e.final_amount.toLocaleString(),"\n\n受取日にお越しください。\nご不明な点がございましたらお気軽にお問い合わせください。\n\n園芸用品予約システム")}static generateReminderMessage(e){var t;return"【受取リマインダー】\n\n".concat(null===(t=e.customer)||void 0===t?void 0:t.full_name," 様\n\n明日は商品の受取日です。\n\n■予約番号: ").concat(e.reservation_number,"\n■受取日: ").concat(new Date(e.reservation_date).toLocaleDateString(),"\n■受取時間: ").concat(e.pickup_time_start||""," - ").concat(e.pickup_time_end||"","\n\nお忘れのないようお気をつけてお越しください。\n\n園芸用品予約システム")}static updateConfig(e){this.config={...this.config,...e}}static getConfig(){return{...this.config}}}c.config={lineEnabled:!0,emailEnabled:!0,smsEnabled:!1,lineAccessToken:r.env.LINE_CHANNEL_ACCESS_TOKEN,emailConfig:{smtpHost:r.env.SMTP_HOST||"smtp.gmail.com",smtpPort:parseInt(r.env.SMTP_PORT||"587"),smtpUser:r.env.SMTP_USER||"",smtpPassword:r.env.SMTP_PASSWORD||"",fromEmail:r.env.FROM_EMAIL||"noreply@nursery.com",fromName:r.env.FROM_NAME||"園芸用品予約システム"}};class o{static async generateReservationPDF(e){try{var t,n,s,a;let{data:l,error:r}=await i.O.from("reservations").select("\n          *,\n          customer:customers (\n            full_name,\n            phone,\n            email\n          ),\n          reservation_items (\n            quantity,\n            unit_price,\n            subtotal,\n            product:products (\n              name,\n              price\n            )\n          )\n        ").eq("id",e).single();if(r||!l)throw Error("予約データの取得に失敗しました");let c={id:l.id,reservation_number:l.reservation_number,customer_name:(null===(t=l.customer)||void 0===t?void 0:t.full_name)||"不明",customer_phone:(null===(n=l.customer)||void 0===n?void 0:n.phone)||"",customer_email:null===(s=l.customer)||void 0===s?void 0:s.email,reservation_date:l.reservation_date,pickup_time_start:l.pickup_time_start,pickup_time_end:l.pickup_time_end,status:l.status,items:(null===(a=l.reservation_items)||void 0===a?void 0:a.map(e=>{var t;return{product_name:(null===(t=e.product)||void 0===t?void 0:t.name)||"不明",quantity:e.quantity,unit_price:e.unit_price,subtotal:e.subtotal}}))||[],total_amount:l.total_amount,discount_amount:l.discount_amount,final_amount:l.final_amount,notes:l.notes,admin_notes:l.admin_notes,created_at:l.created_at};return this.generateReservationPDFHTML(c)}catch(e){throw Error("PDF生成に失敗しました")}}static async generateDailyReportPDF(e){try{let{data:t,error:n}=await i.O.from("reservations").select("\n          *,\n          customer:customers (\n            full_name,\n            phone,\n            email\n          ),\n          reservation_items (\n            quantity,\n            unit_price,\n            subtotal,\n            product:products (\n              name,\n              price\n            )\n          )\n        ").eq("reservation_date",e).order("pickup_time_start",{ascending:!0});if(n)throw Error("予約データの取得に失敗しました");let s=(null==t?void 0:t.map(e=>{var t,n,s,a;return{id:e.id,reservation_number:e.reservation_number,customer_name:(null===(t=e.customer)||void 0===t?void 0:t.full_name)||"不明",customer_phone:(null===(n=e.customer)||void 0===n?void 0:n.phone)||"",customer_email:null===(s=e.customer)||void 0===s?void 0:s.email,reservation_date:e.reservation_date,pickup_time_start:e.pickup_time_start,pickup_time_end:e.pickup_time_end,status:e.status,items:(null===(a=e.reservation_items)||void 0===a?void 0:a.map(e=>{var t;return{product_name:(null===(t=e.product)||void 0===t?void 0:t.name)||"不明",quantity:e.quantity,unit_price:e.unit_price,subtotal:e.subtotal}}))||[],total_amount:e.total_amount,discount_amount:e.discount_amount,final_amount:e.final_amount,notes:e.notes,admin_notes:e.admin_notes,created_at:e.created_at}}))||[],a={by_status:s.reduce((e,t)=>(e[t.status]=(e[t.status]||0)+1,e),{}),by_time_slot:s.reduce((e,t)=>{let n=t.pickup_time_start?"".concat(t.pickup_time_start,"-").concat(t.pickup_time_end):"時間未指定";return e[n]=(e[n]||0)+1,e},{})},l={date:e,total_reservations:s.length,total_amount:s.reduce((e,t)=>e+t.final_amount,0),reservations:s,summary:a};return this.generateDailyReportPDFHTML(l)}catch(e){throw Error("日次レポートPDF生成に失敗しました")}}static generateReservationPDFHTML(e){let t={pending:"保留中",confirmed:"確定",ready:"準備完了",completed:"完了",cancelled:"キャンセル"}[e.status]||e.status,n=e.pickup_time_start&&e.pickup_time_end?"".concat(e.pickup_time_start," - ").concat(e.pickup_time_end):"時間未指定";return'\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8">\n  <title>注文書 - '.concat(e.reservation_number,"</title>\n  <style>\n    body { font-family: 'Helvetica', 'Arial', sans-serif; font-size: 12px; margin: 20px; }\n    .header { text-align: center; margin-bottom: 30px; }\n    .header h1 { font-size: 24px; margin-bottom: 10px; }\n    .info-section { margin-bottom: 20px; }\n    .info-section h2 { font-size: 16px; border-bottom: 2px solid #333; padding-bottom: 5px; }\n    .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }\n    .info-item { margin-bottom: 10px; }\n    .info-item label { font-weight: bold; margin-right: 10px; }\n    .items-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\n    .items-table th, .items-table td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n    .items-table th { background-color: #f5f5f5; font-weight: bold; }\n    .items-table .number { text-align: right; }\n    .total-section { margin-top: 20px; }\n    .total-row { display: flex; justify-content: space-between; margin-bottom: 5px; }\n    .total-row.final { font-weight: bold; font-size: 14px; border-top: 2px solid #333; padding-top: 10px; }\n    .notes { margin-top: 20px; padding: 10px; background-color: #f9f9f9; border-radius: 5px; }\n    .footer { margin-top: 30px; text-align: center; font-size: 10px; color: #666; }\n  </style>\n</head>\n<body>\n  <div class=\"header\">\n    <h1>注文書</h1>\n    <p>予約番号: ").concat(e.reservation_number,'</p>\n  </div>\n\n  <div class="info-grid">\n    <div class="info-section">\n      <h2>顧客情報</h2>\n      <div class="info-item">\n        <label>氏名:</label>\n        <span>').concat(e.customer_name,'</span>\n      </div>\n      <div class="info-item">\n        <label>電話番号:</label>\n        <span>').concat(e.customer_phone,"</span>\n      </div>\n      ").concat(e.customer_email?'\n      <div class="info-item">\n        <label>メールアドレス:</label>\n        <span>'.concat(e.customer_email,"</span>\n      </div>\n      "):"",'\n    </div>\n\n    <div class="info-section">\n      <h2>予約情報</h2>\n      <div class="info-item">\n        <label>受取日:</label>\n        <span>').concat(new Date(e.reservation_date).toLocaleDateString("ja-JP"),'</span>\n      </div>\n      <div class="info-item">\n        <label>受取時間:</label>\n        <span>').concat(n,'</span>\n      </div>\n      <div class="info-item">\n        <label>ステータス:</label>\n        <span>').concat(t,'</span>\n      </div>\n      <div class="info-item">\n        <label>予約日時:</label>\n        <span>').concat(new Date(e.created_at).toLocaleString("ja-JP"),'</span>\n      </div>\n    </div>\n  </div>\n\n  <div class="info-section">\n    <h2>注文内容</h2>\n    <table class="items-table">\n      <thead>\n        <tr>\n          <th>商品名</th>\n          <th class="number">数量</th>\n          <th class="number">単価</th>\n          <th class="number">小計</th>\n        </tr>\n      </thead>\n      <tbody>\n        ').concat(e.items.map(e=>"\n        <tr>\n          <td>".concat(e.product_name,'</td>\n          <td class="number">').concat(e.quantity,'</td>\n          <td class="number">\xa5').concat(e.unit_price.toLocaleString(),'</td>\n          <td class="number">\xa5').concat(e.subtotal.toLocaleString(),"</td>\n        </tr>\n        ")).join(""),'\n      </tbody>\n    </table>\n\n    <div class="total-section">\n      <div class="total-row">\n        <span>小計:</span>\n        <span>\xa5').concat(e.total_amount.toLocaleString(),"</span>\n      </div>\n      ").concat(e.discount_amount>0?'\n      <div class="total-row">\n        <span>割引:</span>\n        <span>-\xa5'.concat(e.discount_amount.toLocaleString(),"</span>\n      </div>\n      "):"",'\n      <div class="total-row final">\n        <span>合計:</span>\n        <span>\xa5').concat(e.final_amount.toLocaleString(),"</span>\n      </div>\n    </div>\n  </div>\n\n  ").concat(e.notes?'\n  <div class="notes">\n    <h3>お客様備考</h3>\n    <p>'.concat(e.notes,"</p>\n  </div>\n  "):"","\n\n  ").concat(e.admin_notes?'\n  <div class="notes">\n    <h3>管理メモ</h3>\n    <p>'.concat(e.admin_notes,"</p>\n  </div>\n  "):"",'\n\n  <div class="footer">\n    <p>ベジライス予約システム - 発行日: ').concat(new Date().toLocaleString("ja-JP"),"</p>\n  </div>\n</body>\n</html>\n    ")}static generateDailyReportPDFHTML(e){return'\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8">\n  <title>日次予約レポート - '.concat(e.date,"</title>\n  <style>\n    body { font-family: 'Helvetica', 'Arial', sans-serif; font-size: 12px; margin: 20px; }\n    .header { text-align: center; margin-bottom: 30px; }\n    .header h1 { font-size: 24px; margin-bottom: 10px; }\n    .summary { margin-bottom: 30px; }\n    .summary-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }\n    .summary-item { background-color: #f5f5f5; padding: 15px; border-radius: 5px; }\n    .summary-item h3 { margin-top: 0; }\n    .reservations-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\n    .reservations-table th, .reservations-table td { border: 1px solid #ddd; padding: 8px; text-align: left; font-size: 10px; }\n    .reservations-table th { background-color: #f5f5f5; font-weight: bold; }\n    .reservations-table .number { text-align: right; }\n    .status-badge { padding: 2px 6px; border-radius: 3px; font-size: 9px; }\n    .status-pending { background-color: #fef3c7; color: #92400e; }\n    .status-confirmed { background-color: #d1fae5; color: #065f46; }\n    .status-ready { background-color: #dbeafe; color: #1e40af; }\n    .status-completed { background-color: #f3f4f6; color: #374151; }\n    .status-cancelled { background-color: #fee2e2; color: #991b1b; }\n    .footer { margin-top: 30px; text-align: center; font-size: 10px; color: #666; }\n  </style>\n</head>\n<body>\n  <div class=\"header\">\n    <h1>日次予約レポート</h1>\n    <p>対象日: ").concat(new Date(e.date).toLocaleDateString("ja-JP"),'</p>\n  </div>\n\n  <div class="summary">\n    <div class="summary-grid">\n      <div class="summary-item">\n        <h3>予約概要</h3>\n        <p>総予約数: ').concat(e.total_reservations,"件</p>\n        <p>総金額: \xa5").concat(e.total_amount.toLocaleString(),'</p>\n      </div>\n      <div class="summary-item">\n        <h3>ステータス別</h3>\n        ').concat(Object.entries(e.summary.by_status).map(e=>{let[t,n]=e;return"\n        <p>".concat(t,": ").concat(n,"件</p>\n        ")}).join(""),'\n      </div>\n    </div>\n  </div>\n\n  <table class="reservations-table">\n    <thead>\n      <tr>\n        <th>予約番号</th>\n        <th>顧客名</th>\n        <th>電話番号</th>\n        <th>受取時間</th>\n        <th>ステータス</th>\n        <th>商品数</th>\n        <th class="number">金額</th>\n        <th>備考</th>\n      </tr>\n    </thead>\n    <tbody>\n      ').concat(e.reservations.map(e=>{let t="status-".concat(e.status),n={pending:"保留中",confirmed:"確定",ready:"準備完了",completed:"完了",cancelled:"キャンセル"}[e.status]||e.status,s=e.pickup_time_start&&e.pickup_time_end?"".concat(e.pickup_time_start,"-").concat(e.pickup_time_end):"未指定";return"\n        <tr>\n          <td>".concat(e.reservation_number,"</td>\n          <td>").concat(e.customer_name,"</td>\n          <td>").concat(e.customer_phone,"</td>\n          <td>").concat(s,'</td>\n          <td><span class="status-badge ').concat(t,'">').concat(n,"</span></td>\n          <td>").concat(e.items.length,'</td>\n          <td class="number">\xa5').concat(e.final_amount.toLocaleString(),"</td>\n          <td>").concat(e.notes||e.admin_notes||"","</td>\n        </tr>\n        ")}).join(""),'\n    </tbody>\n  </table>\n\n  <div class="footer">\n    <p>ベジライス予約システム - 発行日: ').concat(new Date().toLocaleString("ja-JP"),"</p>\n  </div>\n</body>\n</html>\n    ")}static printHTML(e){let t=window.open("","_blank");t&&(t.document.write(e),t.document.close(),t.focus(),t.print())}}function d(e){let{reservation:t,isOpen:n,onClose:r,onSave:c}=e,{showSuccess:o,showError:d}=(0,l.p)(),[m,u]=(0,a.useState)({customer_id:t.customer_id,reservation_date:t.reservation_date,pickup_time_start:t.pickup_time_start||"",pickup_time_end:t.pickup_time_end||"",status:t.status,notes:t.notes||"",admin_notes:t.admin_notes||"",final_amount:t.final_amount}),[h,p]=(0,a.useState)(!1),[v,x]=(0,a.useState)([]),[b,f]=(0,a.useState)([]),[j,_]=(0,a.useState)([]);(0,a.useEffect)(()=>{n&&(g(),N(),y())},[n,t.id]);let g=async()=>{try{let{data:e,error:t}=await i.O.from("customers").select("*").order("full_name",{ascending:!0});if(t)throw t;x(e||[])}catch(e){}},N=async()=>{try{let{data:e,error:t}=await i.O.from("products").select("*").eq("is_available",!0).order("name",{ascending:!0});if(t)throw t;f(e||[])}catch(e){}},y=async()=>{try{let{data:e,error:n}=await i.O.from("reservation_items").select("\n          *,\n          product:products(*)\n        ").eq("reservation_id",t.id);if(n)throw n;_(e||[])}catch(e){}},w=(e,t)=>{u(n=>({...n,[e]:t}))},k=(e,t)=>{_(n=>n.map(n=>n.id===e?{...n,quantity:t,subtotal:n.unit_price*t}:n))},S=async()=>{p(!0);try{let{error:e}=await i.O.from("reservations").update({customer_id:m.customer_id,reservation_date:m.reservation_date,pickup_time_start:m.pickup_time_start||null,pickup_time_end:m.pickup_time_end||null,status:m.status,notes:m.notes||null,admin_notes:m.admin_notes||null,final_amount:m.final_amount,total_amount:j.reduce((e,t)=>e+t.subtotal,0),updated_at:new Date().toISOString()}).eq("id",t.id);if(e)throw e;for(let e of j){let{error:t}=await i.O.from("reservation_items").update({quantity:e.quantity,subtotal:e.subtotal}).eq("id",e.id);if(t)throw t}let{data:n,error:s}=await i.O.from("reservations").select("\n          *,\n          customer:customers(*),\n          reservation_items(\n            *,\n            product:products(*)\n          )\n        ").eq("id",t.id).single();if(s)throw s;o("予約が更新されました"),c(n),r()}catch(e){d("予約の更新に失敗しました")}finally{p(!1)}};return n?(0,s.jsx)("div",{className:"modal fade show d-block",tabIndex:-1,style:{backgroundColor:"rgba(0,0,0,0.5)"},children:(0,s.jsx)("div",{className:"modal-dialog modal-lg modal-dialog-scrollable",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsxs)("h5",{className:"modal-title",children:["予約編集 - ",t.reservation_number]}),(0,s.jsx)("button",{type:"button",className:"btn-close",onClick:r})]}),(0,s.jsx)("div",{className:"modal-body",children:(0,s.jsxs)("div",{className:"row g-3",children:[(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"顧客"}),(0,s.jsx)("select",{className:"form-select",value:m.customer_id,onChange:e=>w("customer_id",e.target.value),children:v.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.full_name," (",e.phone,")"]},e.id))})]}),(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"ステータス"}),(0,s.jsxs)("select",{className:"form-select",value:m.status,onChange:e=>w("status",e.target.value),children:[(0,s.jsx)("option",{value:"pending",children:"保留中"}),(0,s.jsx)("option",{value:"confirmed",children:"確定"}),(0,s.jsx)("option",{value:"ready",children:"準備完了"}),(0,s.jsx)("option",{value:"completed",children:"完了"}),(0,s.jsx)("option",{value:"cancelled",children:"キャンセル"})]})]}),(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"受取日"}),(0,s.jsx)("input",{type:"date",className:"form-control",value:m.reservation_date,onChange:e=>w("reservation_date",e.target.value)})]}),(0,s.jsxs)("div",{className:"col-md-3",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"受取開始時間"}),(0,s.jsx)("input",{type:"time",className:"form-control",value:m.pickup_time_start,onChange:e=>w("pickup_time_start",e.target.value)})]}),(0,s.jsxs)("div",{className:"col-md-3",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"受取終了時間"}),(0,s.jsx)("input",{type:"time",className:"form-control",value:m.pickup_time_end,onChange:e=>w("pickup_time_end",e.target.value)})]}),(0,s.jsxs)("div",{className:"col-12",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"注文内容"}),(0,s.jsx)("div",{className:"table-responsive",children:(0,s.jsxs)("table",{className:"table table-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"商品名"}),(0,s.jsx)("th",{children:"単価"}),(0,s.jsx)("th",{children:"数量"}),(0,s.jsx)("th",{children:"小計"})]})}),(0,s.jsx)("tbody",{children:j.map(e=>{var t;return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:null===(t=e.product)||void 0===t?void 0:t.name}),(0,s.jsxs)("td",{children:["\xa5",e.unit_price.toLocaleString()]}),(0,s.jsx)("td",{children:(0,s.jsx)("input",{type:"number",className:"form-control form-control-sm",value:e.quantity,min:"1",onChange:t=>k(e.id,parseInt(t.target.value)||1)})}),(0,s.jsxs)("td",{children:["\xa5",e.subtotal.toLocaleString()]})]},e.id)})}),(0,s.jsx)("tfoot",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{colSpan:3,children:"合計"}),(0,s.jsxs)("th",{children:["\xa5",j.reduce((e,t)=>e+t.subtotal,0).toLocaleString()]})]})})]})})]}),(0,s.jsxs)("div",{className:"col-12",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"顧客備考"}),(0,s.jsx)("textarea",{className:"form-control",rows:3,value:m.notes,onChange:e=>w("notes",e.target.value),placeholder:"顧客からの備考・要望"})]}),(0,s.jsxs)("div",{className:"col-12",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"管理メモ"}),(0,s.jsx)("textarea",{className:"form-control",rows:3,value:m.admin_notes,onChange:e=>w("admin_notes",e.target.value),placeholder:"管理者向けメモ"})]})]})}),(0,s.jsxs)("div",{className:"modal-footer",children:[(0,s.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:r,children:"キャンセル"}),(0,s.jsx)("button",{type:"button",className:"btn btn-primary",onClick:S,disabled:h,children:h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"spinner-border spinner-border-sm me-2"}),"保存中..."]}):"保存"})]})]})})}):null}function m(){var e,t,n,r;let{showSuccess:m,showError:u}=(0,l.p)(),[h,p]=(0,a.useState)([]),[v,x]=(0,a.useState)(!0),[b,f]=(0,a.useState)("all"),[j,_]=(0,a.useState)(""),[g,N]=(0,a.useState)(""),[y,w]=(0,a.useState)(null),[k,S]=(0,a.useState)(!1),[D,C]=(0,a.useState)(!1);(0,a.useEffect)(()=>{L()},[]);let L=async()=>{try{let{data:e,error:t}=await i.O.from("reservations").select("\n          *,\n          customer:customers(*),\n          reservation_items(\n            *,\n            product:products(*)\n          )\n        ").order("created_at",{ascending:!1});if(t)throw t;p(e||[])}catch(e){p([])}finally{x(!1)}},T=async(e,t)=>{try{let{error:n}=await i.O.from("reservations").update({status:t,..."confirmed"===t&&{confirmation_sent_at:new Date().toISOString()}}).eq("id",e);if(n)throw n;p(h.map(n=>n.id===e?{...n,status:t}:n)),"confirmed"===t&&await P(e),m("ステータスを更新しました","予約ステータスが正常に更新されました。")}catch(e){u("ステータス更新に失敗しました",(null==e?void 0:e.message)||"ステータスの更新中にエラーが発生しました。")}},P=async e=>{try{var t,n,s,a,i,l;m("通知送信中...","予約確定通知を送信しています");let r=await c.sendReservationConfirmation(e);if(r.success){let e="予約確定通知を送信しました",a=[];(null===(t=r.results.line)||void 0===t?void 0:t.success)&&a.push("LINE"),(null===(n=r.results.email)||void 0===n?void 0:n.success)&&a.push("メール"),(null===(s=r.results.sms)||void 0===s?void 0:s.success)&&a.push("SMS"),a.length>0&&(e+=" (".concat(a.join("、"),")")),m("通知送信完了",e)}else{let e=[];(null===(a=r.results.line)||void 0===a?void 0:a.error)&&e.push("LINE: ".concat(r.results.line.error)),(null===(i=r.results.email)||void 0===i?void 0:i.error)&&e.push("メール: ".concat(r.results.email.error)),(null===(l=r.results.sms)||void 0===l?void 0:l.error)&&e.push("SMS: ".concat(r.results.sms.error)),u("通知送信に失敗しました",e.join("\n")||"通知の送信中にエラーが発生しました")}}catch(e){u("通知送信エラー",e.message||"通知の送信中にエラーが発生しました")}},I=async e=>{try{var t,n,s,a,i,l;m("リマインダー送信中...","受取リマインダーを送信しています");let r=await c.sendPickupReminder(e);if(r.success){let e="受取リマインダーを送信しました",a=[];(null===(t=r.results.line)||void 0===t?void 0:t.success)&&a.push("LINE"),(null===(n=r.results.email)||void 0===n?void 0:n.success)&&a.push("メール"),(null===(s=r.results.sms)||void 0===s?void 0:s.success)&&a.push("SMS"),a.length>0&&(e+=" (".concat(a.join("、"),")")),m("リマインダー送信完了",e)}else{let e=[];(null===(a=r.results.line)||void 0===a?void 0:a.error)&&e.push("LINE: ".concat(r.results.line.error)),(null===(i=r.results.email)||void 0===i?void 0:i.error)&&e.push("メール: ".concat(r.results.email.error)),(null===(l=r.results.sms)||void 0===l?void 0:l.error)&&e.push("SMS: ".concat(r.results.sms.error)),u("リマインダー送信に失敗しました",e.join("\n")||"リマインダーの送信中にエラーが発生しました")}}catch(e){u("リマインダー送信エラー",e.message||"リマインダーの送信中にエラーが発生しました")}},E=async e=>{try{m("PDF生成中...","注文書PDFを生成しています");let t=await o.generateReservationPDF(e);o.printHTML(t),m("PDF生成完了","注文書PDFを生成しました")}catch(e){u("PDF生成エラー",e.message||"PDFの生成中にエラーが発生しました")}},O=async()=>{try{let e=new Date().toISOString().split("T")[0];m("PDF生成中...","".concat(e,"の予約レポートを生成しています"));let t=await o.generateDailyReportPDF(e);o.printHTML(t),m("PDF生成完了","当日の予約レポートを生成しました")}catch(e){u("PDF生成エラー",e.message||"PDFの生成中にエラーが発生しました")}},M=e=>{let t={pending:{label:"保留中",className:"bg-warning-subtle text-warning"},confirmed:{label:"確定",className:"bg-success-subtle text-success"},ready:{label:"準備完了",className:"bg-info-subtle text-info"},completed:{label:"完了",className:"bg-secondary-subtle text-secondary"},cancelled:{label:"キャンセル",className:"bg-danger-subtle text-danger"}},n=t[e]||t.pending;return(0,s.jsx)("span",{className:"badge ".concat(n.className),children:n.label})},F=h.filter(e=>{var t,n;let s="all"===b||e.status===b,a=!j||e.reservation_date===j,i=!g||e.reservation_number.toLowerCase().includes(g.toLowerCase())||(null===(t=e.customer)||void 0===t?void 0:t.full_name.toLowerCase().includes(g.toLowerCase()))||(null===(n=e.customer)||void 0===n?void 0:n.phone.includes(g));return s&&a&&i}),q=e=>{w(e),S(!0)},z=e=>{w(e),C(!0)},R=()=>{C(!1),w(null)};return v?(0,s.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{height:"256px"},children:(0,s.jsx)("div",{className:"loading-spinner"})}):(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"row mb-4",children:(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,s.jsx)("h2",{className:"h2 fw-bold text-dark",children:"予約一覧"}),(0,s.jsxs)("div",{className:"d-flex gap-3",children:[(0,s.jsxs)("button",{onClick:()=>{window.location.href="/admin/reservations/new"},className:"btn btn-success",children:[(0,s.jsx)("i",{className:"bi bi-file-earmark-plus me-2"}),"新規予約追加"]}),(0,s.jsxs)("button",{onClick:O,className:"btn btn-outline-primary",children:[(0,s.jsx)("i",{className:"bi bi-file-earmark-bar-graph me-2"}),"当日レポートPDF"]})]})]})})}),(0,s.jsx)("div",{className:"row mb-4",children:(0,s.jsx)("div",{className:"col-12",children:(0,s.jsx)("div",{className:"card",children:(0,s.jsx)("div",{className:"card-body",children:(0,s.jsxs)("div",{className:"row g-3",children:[(0,s.jsxs)("div",{className:"col-lg-3 col-md-6",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"ステータス"}),(0,s.jsxs)("select",{value:b,onChange:e=>f(e.target.value),className:"form-select",children:[(0,s.jsx)("option",{value:"all",children:"すべてのステータス"}),(0,s.jsx)("option",{value:"pending",children:"保留中"}),(0,s.jsx)("option",{value:"confirmed",children:"確定"}),(0,s.jsx)("option",{value:"ready",children:"準備完了"}),(0,s.jsx)("option",{value:"completed",children:"完了"}),(0,s.jsx)("option",{value:"cancelled",children:"キャンセル"})]})]}),(0,s.jsxs)("div",{className:"col-lg-3 col-md-6",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"受取日"}),(0,s.jsx)("input",{type:"date",value:j,onChange:e=>_(e.target.value),className:"form-control"})]}),(0,s.jsxs)("div",{className:"col-lg-4 col-md-6",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"検索"}),(0,s.jsx)("input",{type:"text",value:g,onChange:e=>N(e.target.value),placeholder:"予約番号、顧客名、電話番号で検索",className:"form-control"})]}),(0,s.jsx)("div",{className:"col-lg-2 col-md-6 d-flex align-items-end",children:(0,s.jsxs)("div",{className:"text-muted small",children:[F.length," 件の予約"]})})]})})})})}),(0,s.jsx)("div",{className:"row",children:(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{className:"d-none d-lg-block",children:(0,s.jsx)("div",{className:"table-responsive",children:(0,s.jsxs)("table",{className:"table table-hover",children:[(0,s.jsx)("thead",{className:"table-light",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"fw-medium text-muted text-uppercase small",children:"予約情報"}),(0,s.jsx)("th",{className:"fw-medium text-muted text-uppercase small",children:"顧客情報"}),(0,s.jsx)("th",{className:"fw-medium text-muted text-uppercase small",children:"受取日時"}),(0,s.jsx)("th",{className:"fw-medium text-muted text-uppercase small",children:"金額"}),(0,s.jsx)("th",{className:"fw-medium text-muted text-uppercase small",children:"ステータス"}),(0,s.jsx)("th",{className:"fw-medium text-muted text-uppercase small",children:"アクション"})]})}),(0,s.jsx)("tbody",{children:F.map(e=>{var t,n,a;return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-3 py-3",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"fw-medium text-dark",children:e.reservation_number}),(0,s.jsxs)("div",{className:"small text-muted",children:["作成: ",new Date(e.created_at).toLocaleDateString()]}),e.notes&&(0,s.jsxs)("div",{className:"small text-muted mt-1",children:[(0,s.jsx)("i",{className:"bi bi-file-earmark-text me-1"}),e.notes]})]})}),(0,s.jsx)("td",{className:"px-3 py-3",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"fw-medium text-dark",children:null===(t=e.customer)||void 0===t?void 0:t.full_name}),(0,s.jsxs)("div",{className:"small text-muted",children:[(0,s.jsx)("i",{className:"bi bi-telephone me-1"}),null===(n=e.customer)||void 0===n?void 0:n.phone]}),(null===(a=e.customer)||void 0===a?void 0:a.email)&&(0,s.jsxs)("div",{className:"small text-muted",children:[(0,s.jsx)("i",{className:"bi bi-envelope me-1"}),e.customer.email]})]})}),(0,s.jsxs)("td",{className:"px-3 py-3",children:[(0,s.jsx)("div",{className:"text-dark",children:new Date(e.reservation_date).toLocaleDateString()}),e.pickup_time_start&&e.pickup_time_end&&(0,s.jsxs)("div",{className:"small text-muted",children:[e.pickup_time_start," - ",e.pickup_time_end]})]}),(0,s.jsxs)("td",{className:"px-3 py-3",children:[(0,s.jsxs)("div",{className:"fw-medium text-dark",children:["\xa5",e.final_amount.toLocaleString()]}),e.discount_amount&&e.discount_amount>0&&(0,s.jsxs)("div",{className:"small text-success",children:["割引: -\xa5",e.discount_amount.toLocaleString()]})]}),(0,s.jsx)("td",{className:"px-3 py-3",children:(0,s.jsxs)("select",{value:e.status,onChange:t=>T(e.id,t.target.value),className:"form-select form-select-sm",children:[(0,s.jsx)("option",{value:"pending",children:"保留中"}),(0,s.jsx)("option",{value:"confirmed",children:"確定"}),(0,s.jsx)("option",{value:"ready",children:"準備完了"}),(0,s.jsx)("option",{value:"completed",children:"完了"}),(0,s.jsx)("option",{value:"cancelled",children:"キャンセル"})]})}),(0,s.jsx)("td",{className:"px-3 py-3",children:(0,s.jsxs)("div",{className:"d-flex gap-1",children:[(0,s.jsxs)("button",{onClick:()=>q(e),className:"btn btn-outline-primary btn-sm",children:[(0,s.jsx)("i",{className:"bi bi-eye me-1"}),"詳細"]}),(0,s.jsx)("button",{onClick:()=>E(e.id),className:"btn btn-outline-secondary btn-sm",title:"注文書PDFを生成",children:(0,s.jsx)("i",{className:"bi bi-file-earmark-pdf"})}),"confirmed"===e.status&&!e.reminder_sent_at&&(0,s.jsx)("button",{onClick:()=>I(e.id),className:"btn btn-outline-warning btn-sm",title:"受取リマインダーを送信",children:(0,s.jsx)("i",{className:"bi bi-bell"})}),(0,s.jsx)("button",{onClick:()=>z(e),className:"btn btn-outline-primary btn-sm",title:"予約を編集",children:(0,s.jsx)("i",{className:"bi bi-pencil"})})]})})]},e.id)})})]})})}),(0,s.jsx)("div",{className:"d-lg-none",children:(0,s.jsx)("div",{className:"card-body p-0",children:F.map(e=>{var t,n;return(0,s.jsxs)("div",{className:"border-bottom p-3",children:[(0,s.jsxs)("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"fw-medium text-dark",children:e.reservation_number}),(0,s.jsx)("div",{className:"text-muted",children:null===(t=e.customer)||void 0===t?void 0:t.full_name})]}),(0,s.jsx)("div",{children:M(e.status)})]}),(0,s.jsxs)("div",{className:"row g-3 mb-3 small",children:[(0,s.jsxs)("div",{className:"col-6",children:[(0,s.jsx)("span",{className:"text-muted",children:"受取日:"}),(0,s.jsx)("div",{className:"fw-medium",children:new Date(e.reservation_date).toLocaleDateString()})]}),(0,s.jsxs)("div",{className:"col-6",children:[(0,s.jsx)("span",{className:"text-muted",children:"金額:"}),(0,s.jsxs)("div",{className:"fw-medium",children:["\xa5",e.final_amount.toLocaleString()]})]}),(0,s.jsxs)("div",{className:"col-6",children:[(0,s.jsx)("span",{className:"text-muted",children:"電話:"}),(0,s.jsx)("div",{children:null===(n=e.customer)||void 0===n?void 0:n.phone})]}),(0,s.jsxs)("div",{className:"col-6",children:[(0,s.jsx)("span",{className:"text-muted",children:"作成:"}),(0,s.jsx)("div",{children:new Date(e.created_at).toLocaleDateString()})]})]}),(0,s.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,s.jsx)("div",{className:"flex-grow-1 me-3",children:(0,s.jsxs)("select",{value:e.status,onChange:t=>T(e.id,t.target.value),className:"form-select form-select-sm",children:[(0,s.jsx)("option",{value:"pending",children:"保留中"}),(0,s.jsx)("option",{value:"confirmed",children:"確定"}),(0,s.jsx)("option",{value:"ready",children:"準備完了"}),(0,s.jsx)("option",{value:"completed",children:"完了"}),(0,s.jsx)("option",{value:"cancelled",children:"キャンセル"})]})}),(0,s.jsxs)("div",{className:"d-flex gap-1",children:[(0,s.jsx)("button",{onClick:()=>q(e),className:"btn btn-outline-primary btn-sm",children:"詳細"}),(0,s.jsx)("button",{onClick:()=>E(e.id),className:"btn btn-outline-secondary btn-sm",title:"注文書PDFを生成",children:(0,s.jsx)("i",{className:"bi bi-file-earmark-pdf"})}),"confirmed"===e.status&&!e.reminder_sent_at&&(0,s.jsx)("button",{onClick:()=>I(e.id),className:"btn btn-outline-warning btn-sm",title:"受取リマインダーを送信",children:(0,s.jsx)("i",{className:"bi bi-bell"})}),(0,s.jsx)("button",{onClick:()=>z(e),className:"btn btn-outline-primary btn-sm",title:"予約を編集",children:(0,s.jsx)("i",{className:"bi bi-pencil"})})]})]}),e.notes&&(0,s.jsxs)("div",{className:"mt-2 small text-muted bg-light p-2 rounded",children:[(0,s.jsx)("i",{className:"bi bi-file-earmark-text me-1"}),e.notes]})]},e.id)})})})]})})}),0===F.length&&(0,s.jsx)("div",{className:"row",children:(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"text-center py-5",children:[(0,s.jsx)("i",{className:"bi bi-calendar-x text-muted",style:{fontSize:"4rem"}}),(0,s.jsx)("h3",{className:"h5 fw-medium text-dark mt-3 mb-2",children:"予約が見つかりません"}),(0,s.jsx)("p",{className:"text-muted",children:"検索条件を変更するか、新しい予約を追加してください。"})]})})}),k&&y&&(0,s.jsx)("div",{className:"modal fade show d-block",tabIndex:-1,style:{backgroundColor:"rgba(0,0,0,0.5)"},children:(0,s.jsx)("div",{className:"modal-dialog modal-lg modal-dialog-scrollable",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)("h5",{className:"modal-title",children:"予約詳細"}),(0,s.jsx)("button",{type:"button",className:"btn-close",onClick:()=>S(!1)})]}),(0,s.jsx)("div",{className:"modal-body",children:(0,s.jsxs)("div",{className:"row g-4",children:[(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"row g-3",children:[(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"予約番号"}),(0,s.jsx)("div",{className:"text-dark",children:y.reservation_number})]}),(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"ステータス"}),(0,s.jsx)("div",{children:M(y.status)})]}),(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"受取日"}),(0,s.jsx)("div",{className:"text-dark",children:new Date(y.reservation_date).toLocaleDateString()})]})]})}),(0,s.jsxs)("div",{className:"col-12",children:[(0,s.jsx)("h6",{className:"fw-medium text-dark mb-3",children:"顧客情報"}),(0,s.jsxs)("div",{className:"row g-3",children:[(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"氏名"}),(0,s.jsx)("div",{className:"text-dark",children:null===(e=y.customer)||void 0===e?void 0:e.full_name})]}),(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"電話番号"}),(0,s.jsx)("div",{className:"text-dark",children:null===(t=y.customer)||void 0===t?void 0:t.phone})]}),(null===(n=y.customer)||void 0===n?void 0:n.email)&&(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"メールアドレス"}),(0,s.jsx)("div",{className:"text-dark",children:y.customer.email})]})]})]}),(0,s.jsxs)("div",{className:"col-12",children:[(0,s.jsx)("h6",{className:"fw-medium text-dark mb-3",children:"注文商品"}),(0,s.jsx)("div",{className:"table-responsive",children:(0,s.jsxs)("table",{className:"table table-borderless",children:[(0,s.jsx)("tbody",{children:null===(r=y.reservation_items)||void 0===r?void 0:r.map((e,t)=>{var n;return(0,s.jsxs)("tr",{className:"border-bottom",children:[(0,s.jsxs)("td",{className:"ps-0",children:[(0,s.jsx)("div",{className:"fw-medium",children:null===(n=e.product)||void 0===n?void 0:n.name}),(0,s.jsxs)("div",{className:"small text-muted",children:["\xa5",e.unit_price.toLocaleString()," \xd7 ",e.quantity]})]}),(0,s.jsx)("td",{className:"text-end pe-0",children:(0,s.jsxs)("div",{className:"fw-medium",children:["\xa5",e.subtotal.toLocaleString()]})})]},t)})}),(0,s.jsx)("tfoot",{children:(0,s.jsxs)("tr",{className:"border-top",children:[(0,s.jsx)("td",{className:"ps-0 fw-bold",children:"合計"}),(0,s.jsxs)("td",{className:"text-end pe-0 fw-bold",children:["\xa5",y.final_amount.toLocaleString()]})]})})]})})]}),(y.notes||y.admin_notes)&&(0,s.jsxs)("div",{className:"col-12",children:[(0,s.jsx)("h6",{className:"fw-medium text-dark mb-3",children:"備考・メモ"}),y.notes&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"お客様備考"}),(0,s.jsx)("div",{className:"bg-light p-3 rounded",children:y.notes})]}),y.admin_notes&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"form-label fw-medium",children:"管理メモ"}),(0,s.jsx)("div",{className:"bg-warning-subtle p-3 rounded",children:y.admin_notes})]})]})]})}),(0,s.jsxs)("div",{className:"modal-footer",children:[(0,s.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>S(!1),children:"閉じる"}),(0,s.jsxs)("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>E(y.id),children:[(0,s.jsx)("i",{className:"bi bi-file-earmark-pdf me-2"}),"PDF生成"]}),(0,s.jsxs)("button",{type:"button",className:"btn btn-primary",onClick:()=>z(y),children:[(0,s.jsx)("i",{className:"bi bi-pencil me-2"}),"編集"]})]})]})})}),D&&y&&(0,s.jsx)(d,{reservation:y,isOpen:D,onClose:R,onSave:e=>{p(t=>t.map(t=>t.id===e.id?e:t)),R()}})]})}},2141:function(e,t,n){"use strict";n.d(t,{O:function(){return s}});let s=(0,n(6580).eI)("https://uscvsipskkbegcfktjyt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVzY3ZzaXBza2tiZWdjZmt0anl0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0MDI4MzUsImV4cCI6MjA2Nzk3ODgzNX0.VhcGWXb-PpHTfqPApSIG4C6xXLik8JClsNhOdJIgdzw")},5566:function(e){var t,n,s,a=e.exports={};function i(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}function r(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:l}catch(e){n=l}}();var c=[],o=!1,d=-1;function m(){o&&s&&(o=!1,s.length?c=s.concat(c):d=-1,c.length&&u())}function u(){if(!o){var e=r(m);o=!0;for(var t=c.length;t;){for(s=c,c=[];++d<t;)s&&s[d].run();d=-1,t=c.length}s=null,o=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===l||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function p(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||o||r(u)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=p,a.addListener=p,a.once=p,a.off=p,a.removeListener=p,a.removeAllListeners=p,a.emit=p,a.prependListener=p,a.prependOnceListener=p,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}}]);