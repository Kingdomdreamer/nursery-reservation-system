(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[978],{7805:function(e,s,t){Promise.resolve().then(t.bind(t,9122))},7755:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});var a=t(7437),r=t(2265);async function n(e){try{let s=await fetch("https://zipcloud.ibsnet.co.jp/api/search?zipcode=".concat(e)),t=await s.json();if(200===t.status&&t.results&&t.results.length>0){let e=t.results[0];return{prefecture:e.address1,city:e.address2,town:e.address3,fullAddress:"".concat(e.address1).concat(e.address2).concat(e.address3)}}return null}catch(e){return console.error("住所検索エラー:",e),null}}function l(e){let{formConfig:s}=e,[t,l]=(0,r.useState)({}),[c,i]=(0,r.useState)(new Set),[o,d]=(0,r.useState)(!1),u=e=>s=>{l({...t,[e]:s.target.value})},m=e=>{let s=function(e){let s=e.replace(/[^0-9]/g,"");return s.length<=3?s:"".concat(s.slice(0,3),"-").concat(s.slice(3,7))}(e.target.value);l({...t,postal_code:s}),s.replace(/[^0-9]/g,"").length<7&&c.size>0&&(l(e=>({...e,prefecture:"",city:"",address:""})),i(new Set))},x=async()=>{let e=(t.postal_code||"").replace(/[^0-9]/g,"");if(7===e.length){d(!0);try{let s=await n(e);s&&(l(e=>({...e,prefecture:s.prefecture||"",city:s.city||"",address:s.town||""})),i(new Set(["prefecture","city"])))}catch(e){console.error("住所検索エラー:",e)}finally{d(!1)}}},p=()=>{l(e=>({...e,prefecture:"",city:"",address:""})),i(new Set)},h=e=>c.has(e)&&("prefecture"===e||"city"===e)?"w-full px-3 py-2 border border-green-300 bg-green-50 rounded-md text-sm":"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",g=e=>c.has(e)&&("prefecture"===e||"city"===e),f=()=>{let e=(t.postal_code||"").replace(/[^0-9]/g,"");return 0===e.length?"郵便番号を入力してください":e.length<7?"あと".concat(7-e.length,"桁入力してください"):7===e.length?"タップして住所を検索":""},b=s.fields.filter(e=>!1!==e.enabled);return(0,a.jsxs)("div",{className:"max-w-lg mx-auto bg-white border rounded-lg p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:s.name}),(0,a.jsx)("p",{className:"text-gray-600 text-sm",children:s.description})]}),(0,a.jsxs)("form",{className:"space-y-6",children:[b.map(e=>{var s,r,n;let l=t[e.id]||"";return"postal_code"===e.id?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e.label,e.required&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"}),o&&(0,a.jsx)("span",{className:"text-sm text-blue-600 ml-2",children:"住所を検索中..."})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"text",value:l,onChange:m,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:e.placeholder||"例: 123-4567",maxLength:8}),(0,a.jsx)("button",{type:"button",onClick:x,disabled:o||7!==l.replace(/[^0-9]/g,"").length,title:f(),className:"px-4 py-2 text-sm font-medium rounded-md transition-colors ".concat(o||7!==l.replace(/[^0-9]/g,"").length?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:o?"検索中...":"住所検索"}),c.size>0&&(0,a.jsx)("button",{type:"button",onClick:p,className:"px-3 py-2 text-sm bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"クリア"})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,a.jsx)("p",{children:"\uD83D\uDCCD 郵便番号を7桁入力後、「住所検索」ボタンをタップで住所が自動入力されます"}),(0,a.jsx)("p",{children:"\uD83D\uDD12 都道府県・市区町村は自動入力、町名以降は編集できます"})]})]},e.id):"prefecture"===e.id||"city"===e.id?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e.label,e.required&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"}),c.has(e.id)&&(0,a.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(自動入力)"})]}),(0,a.jsx)("input",{type:"text",value:l,onChange:u(e.id),className:h(e.id),placeholder:e.placeholder,readOnly:g(e.id)})]},e.id):(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e.label,e.required&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),"textarea"===e.type?(0,a.jsx)("textarea",{value:l,onChange:u(e.id),placeholder:e.placeholder,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3}):"select"===e.type?(0,a.jsxs)("select",{value:l,onChange:u(e.id),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"選択してください"}),null===(s=e.options)||void 0===s?void 0:s.map((e,s)=>(0,a.jsx)("option",{value:e,children:e},s))]}):"radio"===e.type?(0,a.jsx)("div",{className:"space-y-2",children:null===(r=e.options)||void 0===r?void 0:r.map((s,t)=>(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",name:e.id,value:s,checked:l===s,onChange:u(e.id),className:"mr-2"}),s]},t))}):"checkbox"===e.type?(0,a.jsx)("div",{className:"space-y-2",children:null===(n=e.options)||void 0===n?void 0:n.map((e,s)=>(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",value:e,className:"mr-2"}),e]},s))}):(0,a.jsx)("input",{type:e.type,value:l,onChange:u(e.id),placeholder:e.placeholder,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]},e.id)}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"商品選択"}),(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"選択された商品がここに表示されます"})})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("div",{className:"text-lg font-semibold",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"小計: "}),(0,a.jsx)("span",{className:"text-gray-900",children:"\xa50"})]})})]}),(0,a.jsx)("button",{type:"button",className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors",disabled:!0,children:"予約内容を確認する"})]}),(0,a.jsx)("div",{className:"text-center text-xs text-gray-500",children:"※ これはプレビューです。実際の予約はできません。"})]})}},6882:function(e,s,t){"use strict";t.d(s,{JO:function(){return e_},PJ:function(){return eN}});var a=t(7437),r=t(9397),n=t(4630),l=t(8930),c=t(2489),i=t(3229),o=t(8867),d=t(3247),u=t(740),m=t(9076),x=t(2660),p=t(6858),h=t(2451),g=t(407),f=t(875),b=t(8293),y=t(7684),Z=t(2369),v=t(5805),j=t(9663),N=t(7692),w=t(1047),_=t(1723),k=t(8736),I=t(804),C=t(2735),S=t(7689),J=t(4794),z=t(6275),P=t(8226),O=t(5252),D=t(3041),E=t(9345),q=t(8335),A=t(8919),X=t(2718),L=t(3774),M=t(2048),R=t(7877),T=t(5302),V=t(5131),Y=t(3639),B=t(3245),F=t(112),G=t(2208),Q=t(7769),U=t(5884),W=t(4415),H=t(6337),K=t(9711),$=t(1567),ee=t(91),es=t(8728),et=t(9637),ea=t(7586),er=t(1473),en=t(4766),el=t(2252),ec=t(7404),ei=t(3057),eo=t(2879),ed=t(9547),eu=t(9646),em=t(5929),ex=t(1341),ep=t(6540),eh=t(6595),eg=t(8997),ef=t(8896),eb=t(2720),ey=t(1178),eZ=t(7414),ev=t(401),ej=t(3388);let eN={add:r.Z,edit:n.Z,delete:l.Z,remove:c.Z,save:i.Z,copy:o.Z,search:d.Z,filter:u.Z,refresh:m.Z,back:x.Z,forward:p.Z,up:h.Z,down:g.Z,chevronDown:f.Z,menu:b.Z,more:y.Z,user:Z.Z,users:v.Z,profile:j.Z,logout:N.Z,calendar:w.Z,clock:_.Z,file:k.Z,document:k.Z,image:I.Z,download:C.Z,upload:S.Z,product:J.Z,cart:z.Z,payment:P.Z,money:O.Z,phone:D.Z,mail:E.Z,link:q.Z,share:A.Z,message:X.Z,location:L.Z,map:M.Z,navigation:R.Z,success:T.Z,error:V.Z,warning:Y.Z,info:B.Z,help:F.Z,eye:G.Z,eyeOff:Q.Z,show:G.Z,hide:Q.Z,expand:U.Z,collapse:W.Z,lock:H.Z,unlock:K.Z,security:H.Z,exit:N.Z,chart:$.Z,stats:$.Z,database:ee.Z,settings:es.Z,admin:es.Z,config:es.Z,home:et.Z,dashboard:et.Z,list:ea.Z,grid:er.Z,notification:en.Z,alert:el.Z,qrcode:ec.Z,plant:ei.Z,seed:J.Z,flower:eo.Z,tree:ei.Z,leaf:ed.Z,garden:eu.Z,sun:em.Z,cloud:ex.Z,rain:ex.Z,weather:em.Z,loading:ep.Z,spinner:m.Z,star:eh.Z,heart:eg.Z,target:ef.Z,tag:eb.Z,bookmark:ey.Z,gift:eZ.Z,check:ev.Z,cancel:c.Z,confirm:T.Z,customerInfo:Z.Z,reservationInfo:w.Z,otherInfo:k.Z,packageIcon:J.Z,mobileIcon:ej.Z,saveIcon:i.Z,qrIcon:ec.Z,searchIcon:d.Z,deleteIcon:l.Z,closeIcon:c.Z,moneyIcon:O.Z},ew={xs:12,sm:16,md:20,lg:24,xl:32,"2xl":48},e_=e=>{let{icon:s,size:t="md",className:r="",color:n,...l}=e,c="number"==typeof t?t:ew[t];return(0,a.jsx)(s,{width:c,height:c,className:r,color:n,...l})}},9122:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return o}});var a=t(7437),r=t(2265),n=t(9376),l=t(2141),c=t(7755),i=t(6882);function o(){let e=(0,n.useParams)().formId,[s,t]=(0,r.useState)(null),[o,d]=(0,r.useState)(!0),[u,m]=(0,r.useState)(null),[x,p]=(0,r.useState)(!1);(0,r.useEffect)(()=>{e&&(g(),h())},[e]);let h=()=>{p(window.navigator.userAgent.includes("Line/"))},g=async()=>{d(!0),m(null);try{let{data:s,error:a}=await l.OQ.from("forms").select("\n          *,\n          form_fields(*),\n          form_products(\n            *,\n            product:products(\n              *,\n              category:product_categories(*)\n            )\n          )\n        ").eq("id",e).eq("is_active",!0).single();if(a)throw a;if(!s){m("フォームが見つかりません");return}let r=new Date;if(s.valid_from&&new Date(s.valid_from)>r){m("このフォームはまだ受付開始時刻になっていません");return}if(s.valid_to&&new Date(s.valid_to)<r){m("このフォームの受付は終了しました");return}let n={id:s.id,name:s.name,description:s.description,fields:(s.form_fields||[]).map(e=>({id:e.field_id,type:e.field_type,label:e.label,placeholder:e.placeholder,required:e.is_required,options:e.options,description:e.description,category:e.category||"other",enabled:e.is_enabled})),products:(s.form_products||[]).map(e=>{var s;return{id:e.product.id,name:e.product.name,category_name:null===(s=e.product.category)||void 0===s?void 0:s.name,price:e.product.price,variation_name:e.variation_name,selected_price:e.selected_price||e.product.price,selected_variation:e.variation_name}}),settings:{showProgress:s.show_progress||!0,allowEdit:s.allow_edit||!0,confirmationMessage:s.confirmation_message||"ご予約ありがとうございました。",businessName:s.business_name||"",validFrom:s.valid_from,validTo:s.valid_to,isActive:s.is_active}};t(n)}catch(e){console.error("フォーム設定の取得に失敗しました:",e),m("フォーム設定の読み込みに失敗しました")}finally{d(!1)}};return o?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(i.JO,{icon:i.PJ.loading,size:"xl",className:"animate-spin text-blue-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"フォームを読み込み中..."})]})}):u?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[(0,a.jsx)(i.JO,{icon:i.PJ.error,size:"xl",className:"text-red-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"アクセスできません"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:u}),(0,a.jsx)("button",{onClick:()=>window.history.back(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"戻る"})]})}):s?(0,a.jsxs)("div",{className:"min-h-screen ".concat(x?"bg-white":"bg-gray-50"),children:[!x&&(0,a.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-lg mx-auto px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(i.JO,{icon:i.PJ.plant,size:"lg",className:"text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:s.settings.businessName||"種苗店予約システム"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"予約フォーム"})]})]})})}),(0,a.jsx)("div",{className:"".concat(x?"p-0":"p-4"),children:(0,a.jsx)("div",{className:"".concat(x?"":"max-w-lg mx-auto"),children:(0,a.jsx)(c.Z,{formConfig:s})})}),!x&&(0,a.jsx)("div",{className:"bg-white border-t border-gray-200 mt-8",children:(0,a.jsx)("div",{className:"max-w-lg mx-auto px-4 py-6 text-center",children:(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Powered by ",s.settings.businessName||"種苗店予約システム"]})})})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[(0,a.jsx)(i.JO,{icon:i.PJ.warning,size:"xl",className:"text-yellow-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"フォームが見つかりません"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"指定されたフォームは存在しないか、無効になっています。"}),(0,a.jsx)("button",{onClick:()=>window.history.back(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"戻る"})]})})}},2141:function(e,s,t){"use strict";t.d(s,{OQ:function(){return i}});var a=t(6580),r=t(5566);let n="https://uscvsipskkbegcfktjyt.supabase.co",l=null,c=null,i=l=(0,a.eI)(n,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVzY3ZzaXBza2tiZWdjZmt0anl0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0MDI4MzUsImV4cCI6MjA2Nzk3ODgzNX0.VhcGWXb-PpHTfqPApSIG4C6xXLik8JClsNhOdJIgdzw",{auth:{persistSession:!0,autoRefreshToken:!0,storage:window.localStorage}});(()=>{if(!c){let e=r.env.SUPABASE_SERVICE_ROLE_KEY||"your-service-role-key";c=(0,a.eI)(n,e,{auth:{autoRefreshToken:!1,persistSession:!1}})}})(),window.addEventListener("beforeunload",()=>{l=null,c=null})},9376:function(e,s,t){"use strict";var a=t(5475);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}})}},function(e){e.O(0,[789,901,971,117,744],function(){return e(e.s=7805)}),_N_E=e.O()}]);