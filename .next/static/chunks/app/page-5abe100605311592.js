(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7618:function(e,s,r){Promise.resolve().then(r.bind(r,7380))},7380:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return f}});var i=r(7437),l=r(2265);function t(e){let{formData:s,setFormData:r,errors:t}=e,[a,n]=(0,l.useState)(!1),[c,d]=(0,l.useState)(new Set),o=e=>i=>{r({...s,[e]:i.target.value})},m=e=>{let s=e.replace(/[^0-9]/g,"");return 7===s.length?"".concat(s.slice(0,3),"-").concat(s.slice(3)):s.length<=3?s:"".concat(s.slice(0,3),"-").concat(s.slice(3,7))},h=async e=>{n(!0);try{let i=e.replace(/[^0-9]/g,"");if(7!==i.length)return!1;let l=await fetch("https://zipcloud.ibsnet.co.jp/api/search?zipcode=".concat(i));if(!l.ok)throw Error("APIリクエストエラー: ".concat(l.status));let t=await l.json();if(200!==t.status||!t.results||!(t.results.length>0))return!1;{let i=t.results[0];return r({...s,zipcode:e,prefecture:i.address1,city:i.address2,town:i.address3}),d(new Set(["prefecture","city","town"])),!0}}catch(e){return!1}finally{n(!1)}},p=async()=>{if(7!==s.zipcode.replace(/[^0-9]/g,"").length){alert("郵便番号は7桁で入力してください（例: 123-4567）");return}await h(s.zipcode)||(alert("郵便番号「".concat(s.zipcode,"」に該当する住所が見つかりませんでした。\n\n※ 全国の郵便番号に対応していますが、存在しない郵便番号や形式が正しくない場合は検索できません。")),d(new Set))},x=e=>c.has(e)&&("prefecture"===e||"city"===e);return(0,i.jsxs)("div",{className:"form-mailer-section",children:[(0,i.jsxs)("div",{className:"form-mailer-info",children:["お客様の基本情報をご入力ください。必須項目は",(0,i.jsx)("span",{className:"form-mailer-required",children:"*"}),"マークでご確認いただけます。"]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsxs)("label",{className:"form-mailer-label",children:["お名前",(0,i.jsx)("span",{className:"form-mailer-required",children:"*"})]}),(0,i.jsx)("input",{type:"text",value:s.name,onChange:o("name"),className:"form-mailer-input",placeholder:"山田 太郎"}),t.name&&(0,i.jsx)("span",{className:"form-mailer-error",children:t.name})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsxs)("label",{className:"form-mailer-label",children:["フリガナ",(0,i.jsx)("span",{className:"form-mailer-required",children:"*"})]}),(0,i.jsx)("input",{type:"text",value:s.furigana,onChange:o("furigana"),className:"form-mailer-input",placeholder:"ヤマダ タロウ"}),t.furigana&&(0,i.jsx)("span",{className:"form-mailer-error",children:t.furigana})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsxs)("label",{className:"form-mailer-label",children:["電話番号",(0,i.jsx)("span",{className:"form-mailer-required",children:"*"})]}),(0,i.jsx)("input",{type:"tel",value:s.phone,onChange:o("phone"),className:"form-mailer-input",placeholder:"090-1234-5678"}),t.phone&&(0,i.jsx)("span",{className:"form-mailer-error",children:t.phone})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsxs)("label",{className:"form-mailer-label",children:["郵便番号",a&&(0,i.jsx)("span",{style:{fontSize:"12px",color:"#666666",marginLeft:"8px"},children:"住所を検索中..."})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"flex-start"},children:[(0,i.jsx)("input",{type:"text",value:s.zipcode,onChange:e=>{let i=m(e.target.value);r({...s,zipcode:i}),i.replace(/[^0-9]/g,"").length<7&&c.size>0&&(r({...s,zipcode:i,prefecture:"",city:"",town:""}),d(new Set))},onKeyDown:e=>{"Enter"!==e.key||(e.preventDefault(),7!==s.zipcode.replace(/[^0-9]/g,"").length||a||p())},className:"form-mailer-input",placeholder:"例: 123-4567",maxLength:8,style:{flex:"1"}}),(0,i.jsx)("button",{type:"button",onClick:p,disabled:a||7!==s.zipcode.replace(/[^0-9]/g,"").length,title:(()=>{let e=s.zipcode.replace(/[^0-9]/g,"");return 0===e.length?"郵便番号を入力してください":e.length<7?"あと".concat(7-e.length,"桁入力してください"):7===e.length?"タップして住所を検索":""})(),className:a||7!==s.zipcode.replace(/[^0-9]/g,"").length?"form-mailer-button-secondary":"form-mailer-button",style:{width:"auto",padding:"12px 16px",margin:"0",fontSize:"14px",backgroundColor:a||7!==s.zipcode.replace(/[^0-9]/g,"").length?"#cccccc":"#333333",cursor:a||7!==s.zipcode.replace(/[^0-9]/g,"").length?"not-allowed":"pointer"},children:a?"検索中...":"住所検索"}),c.size>0&&(0,i.jsx)("button",{type:"button",onClick:()=>{r({...s,prefecture:"",city:"",town:""}),d(new Set)},className:"form-mailer-button-secondary",style:{width:"auto",padding:"12px 16px",margin:"0",fontSize:"14px"},children:"クリア"})]}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#666666",marginTop:"8px"},children:"郵便番号を7桁入力後、「住所検索」ボタンで住所が自動入力されます。全国の郵便番号に対応しています。"}),t.zipcode&&(0,i.jsx)("span",{className:"form-mailer-error",children:t.zipcode})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"20px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{className:"form-mailer-label",children:["都道府県",c.has("prefecture")&&(0,i.jsx)("span",{style:{fontSize:"11px",color:"#999999",marginLeft:"4px"},children:"(自動入力)"})]}),(0,i.jsx)("input",{type:"text",value:s.prefecture,onChange:o("prefecture"),className:"form-mailer-input",placeholder:"東京都",readOnly:x("prefecture"),style:{backgroundColor:x("prefecture")?"#f5f5f5":"#ffffff"}}),t.prefecture&&(0,i.jsx)("span",{className:"form-mailer-error",children:t.prefecture})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{className:"form-mailer-label",children:["市区町村",c.has("city")&&(0,i.jsx)("span",{style:{fontSize:"11px",color:"#999999",marginLeft:"4px"},children:"(自動入力)"})]}),(0,i.jsx)("input",{type:"text",value:s.city,onChange:o("city"),className:"form-mailer-input",placeholder:"渋谷区",readOnly:x("city"),style:{backgroundColor:x("city")?"#f5f5f5":"#ffffff"}}),t.city&&(0,i.jsx)("span",{className:"form-mailer-error",children:t.city})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsxs)("label",{className:"form-mailer-label",children:["町名",c.has("town")&&(0,i.jsx)("span",{style:{fontSize:"11px",color:"#999999",marginLeft:"4px"},children:"(自動入力されました)"})]}),(0,i.jsx)("input",{type:"text",value:s.town||"",onChange:o("town"),className:"form-mailer-input",placeholder:"神南"}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#666666",marginTop:"4px"},children:"町名以降の項目は編集可能です"})]}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("label",{className:"form-mailer-label",children:"番地・建物名・部屋番号"}),(0,i.jsx)("input",{type:"text",value:s.addressDetail,onChange:o("addressDetail"),className:"form-mailer-input",placeholder:"1-2-3 サンプルマンション101号室"}),t.addressDetail&&(0,i.jsx)("span",{className:"form-mailer-error",children:t.addressDetail})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"20px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"form-mailer-label",children:"性別"}),(0,i.jsxs)("select",{value:s.gender,onChange:o("gender"),className:"form-mailer-select",children:[(0,i.jsx)("option",{value:"male",children:"男性"}),(0,i.jsx)("option",{value:"female",children:"女性"}),(0,i.jsx)("option",{value:"other",children:"その他"})]}),t.gender&&(0,i.jsx)("span",{className:"form-mailer-error",children:t.gender})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"form-mailer-label",children:"生年月日"}),(0,i.jsx)("input",{type:"date",value:s.birthDate,onChange:o("birthDate"),className:"form-mailer-input"}),t.birthDate&&(0,i.jsx)("span",{className:"form-mailer-error",children:t.birthDate})]})]})]})}function a(e){var s,r,i,l;let t=[];return(null===(s=e.name)||void 0===s?void 0:s.trim())||t.push({field:"name",message:"お名前は必須です"}),(null===(r=e.phone)||void 0===r?void 0:r.trim())||t.push({field:"phone",message:"電話番号は必須です"}),e.products&&0!==e.products.length||t.push({field:"products",message:"商品を選択してください"}),e.products&&e.products.forEach((e,s)=>{e.productId||t.push({field:"product_".concat(s,"_id"),message:"商品".concat(s+1,"の選択が無効です")}),(!e.quantity||e.quantity<1)&&t.push({field:"product_".concat(s,"_quantity"),message:"商品".concat(s+1,"の数量は1以上にしてください")}),e.pickupDate||t.push({field:"product_".concat(s,"_date"),message:"商品".concat(s+1,"の引き取り日を選択してください")})}),e.phone&&(i=e.phone,!/^(\d{2,4}-?\d{1,4}-?\d{4}|\d{10,11})$/.test(i.replace(/[^\d-]/g,"")))&&t.push({field:"phone",message:"電話番号の形式が正しくありません"}),e.zipcode&&(l=e.zipcode,!/^\d{3}-?\d{4}$/.test(l))&&t.push({field:"zipcode",message:"郵便番号の形式が正しくありません（例：123-4567）"}),{isValid:0===t.length,errors:t}}class n{shouldShowPricing(){return!this.settings||"hidden"!==this.settings.pricing_display_mode}shouldShowItemPrices(){return!this.settings||"full"===this.settings.pricing_display_mode||"custom"===this.settings.pricing_display_mode&&this.settings.show_item_prices}shouldShowQuantity(){return!this.settings||"full"===this.settings.pricing_display_mode||"custom"===this.settings.pricing_display_mode&&this.settings.show_item_quantity}shouldShowSubtotal(){return!this.settings||"full"===this.settings.pricing_display_mode||"custom"===this.settings.pricing_display_mode&&this.settings.show_subtotal}shouldShowTotal(){return!this.settings||"hidden"!==this.settings.pricing_display_mode&&("full"===this.settings.pricing_display_mode||"summary"===this.settings.pricing_display_mode||"custom"===this.settings.pricing_display_mode&&this.settings.show_total_amount)}getDisplayModeDescription(){if(!this.settings)return"標準表示";switch(this.settings.pricing_display_mode){case"full":return"詳細表示 - すべての価格情報を表示";case"summary":return"合計のみ表示 - 合計金額のみを表示";case"hidden":return"価格非表示 - 価格情報を表示しません";case"custom":return"カスタム表示 - 個別設定に基づいて表示";default:return"標準表示"}}constructor(e){this.settings=e}}function c(e){return e.products?[...new Set(e.products.map(e=>e.pickupDate).filter(e=>e))].sort():[]}function d(e,s){return e.products?e.products.reduce((e,r)=>{let i=s.find(e=>e.id===r.productId);return e+(i?i.price*r.quantity:0)},0):0}function o(e){let{productItems:s,setProductItems:r,availableProducts:l,pricingSettings:t,errors:a}=e,c=new n(t),d=e=>{s.length>1&&r(s.filter((s,r)=>r!==e))},o=(e,i,l)=>{let t=[...s];t[e]={...t[e],[i]:l},r(t)},m=()=>s.reduce((e,s)=>{let r=l.find(e=>e.id===s.productId);return e+(r?r.price*s.quantity:0)},0),h=e=>{let s=l.find(s=>s.id===e.productId);return s?s.price*e.quantity:0};return(0,i.jsxs)("div",{className:"form-mailer-section",children:[(0,i.jsx)("div",{className:"form-mailer-info",children:"ご注文いただく商品をお選びください。複数の商品をご注文の場合は「商品を追加」ボタンで追加できます。"}),s.map((e,r)=>{var t,n,m,p,x,u;return(0,i.jsxs)("div",{style:{border:"1px solid #e0e0e0",borderRadius:"4px",padding:"20px",marginBottom:"20px",backgroundColor:"#fafafa"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",borderBottom:"1px solid #e0e0e0",paddingBottom:"12px"},children:[(0,i.jsxs)("h4",{style:{margin:"0",fontSize:"16px",fontWeight:"600",color:"#333333"},children:["商品 ",r+1]}),s.length>1&&(0,i.jsx)("button",{type:"button",onClick:()=>d(r),className:"form-mailer-button-secondary",style:{width:"auto",padding:"8px 12px",fontSize:"12px",margin:"0"},children:"削除"})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,i.jsxs)("label",{className:"form-mailer-label",children:["商品",(0,i.jsx)("span",{className:"form-mailer-required",children:"*"})]}),(0,i.jsxs)("select",{value:e.productId,onChange:e=>o(r,"productId",e.target.value),className:"form-mailer-select",children:[(0,i.jsx)("option",{value:"",children:"商品を選択してください"}),l.map(e=>(0,i.jsxs)("option",{value:e.id,children:[e.name,c.shouldShowItemPrices()&&" - \xa5".concat(e.price.toLocaleString())]},e.id))]}),(null==a?void 0:null===(n=a.products)||void 0===n?void 0:null===(t=n[r])||void 0===t?void 0:t.productId)&&(0,i.jsx)("span",{className:"form-mailer-error",children:a.products[r].productId.message})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{className:"form-mailer-label",children:["数量",(0,i.jsx)("span",{className:"form-mailer-required",children:"*"})]}),(0,i.jsx)("input",{type:"number",min:"1",max:"50",value:e.quantity,onChange:e=>o(r,"quantity",parseInt(e.target.value)||1),className:"form-mailer-input",placeholder:"1"}),(null==a?void 0:null===(p=a.products)||void 0===p?void 0:null===(m=p[r])||void 0===m?void 0:m.quantity)&&(0,i.jsx)("span",{className:"form-mailer-error",children:a.products[r].quantity.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{className:"form-mailer-label",children:["引き取り日",(0,i.jsx)("span",{className:"form-mailer-required",children:"*"})]}),(0,i.jsx)("input",{type:"date",value:e.pickupDate,onChange:e=>o(r,"pickupDate",e.target.value),className:"form-mailer-input",min:new Date().toISOString().split("T")[0]}),(null==a?void 0:null===(u=a.products)||void 0===u?void 0:null===(x=u[r])||void 0===x?void 0:x.pickupDate)&&(0,i.jsx)("span",{className:"form-mailer-error",children:a.products[r].pickupDate.message})]})]}),e.productId&&c.shouldShowSubtotal()&&(0,i.jsxs)("div",{style:{backgroundColor:"#ffffff",border:"1px solid #e0e0e0",borderRadius:"4px",padding:"12px",textAlign:"right"},children:[(0,i.jsx)("span",{style:{color:"#666666",fontSize:"14px"},children:"この商品の小計: "}),(0,i.jsxs)("span",{style:{fontWeight:"600",color:"#333333",fontSize:"16px"},children:["\xa5",h(e).toLocaleString()]})]})]},r)}),(0,i.jsx)("button",{type:"button",onClick:()=>{r([...s,{productId:"",quantity:1,pickupDate:""}])},className:"form-mailer-button-secondary",style:{marginBottom:"20px"},children:"商品を追加"}),s.length>0&&m()>0&&c.shouldShowTotal()&&(0,i.jsxs)("div",{style:{backgroundColor:"#f5f5f5",border:"2px solid #333333",borderRadius:"4px",padding:"20px",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"16px",color:"#333333",marginBottom:"8px"},children:"合計金額"}),(0,i.jsxs)("div",{style:{fontSize:"24px",fontWeight:"700",color:"#333333"},children:["\xa5",m().toLocaleString()]})]})]})}function m(e){var s;let{reservationData:r,availableProducts:t,pricingSettings:o,lineAuthInfo:m,onConfirm:h,onEdit:p,isLoading:x=!1,errorMessage:u}=e,[f,j]=(0,l.useState)(!1),[g,y]=(0,l.useState)([]),b=new n(o);(0,l.useEffect)(()=>{let e=a(r);e.isValid?y([]):y(e.errors.map(e=>e.message))},[r]);let v=d(r,t),N=[r.prefecture,r.city,r.town,r.addressDetail].filter(Boolean).join(""),S=c(r),w=async()=>{let e=a(r);if(!e.isValid){y(e.errors.map(e=>e.message));return}j(!0);try{await h()}finally{j(!1)}};return(0,i.jsx)("div",{className:"form-mailer-style",children:(0,i.jsxs)("div",{className:"form-mailer-container",children:[(0,i.jsxs)("div",{className:"form-mailer-progress",children:[(0,i.jsxs)("div",{className:"form-mailer-step",children:[(0,i.jsx)("div",{className:"form-mailer-step-number",children:"1"}),(0,i.jsx)("span",{children:"入力"})]}),(0,i.jsx)("div",{className:"form-mailer-step-arrow",children:"→"}),(0,i.jsxs)("div",{className:"form-mailer-step active",children:[(0,i.jsx)("div",{className:"form-mailer-step-number",children:"2"}),(0,i.jsx)("span",{children:"確認"})]}),(0,i.jsx)("div",{className:"form-mailer-step-arrow",children:"→"}),(0,i.jsxs)("div",{className:"form-mailer-step",children:[(0,i.jsx)("div",{className:"form-mailer-step-number",children:"3"}),(0,i.jsx)("span",{children:"完了"})]})]}),(0,i.jsx)("h1",{className:"form-mailer-title",children:"入力内容確認"}),(0,i.jsx)("div",{className:"form-mailer-info",children:"以下の内容でご予約を確定いたします。内容をご確認の上、問題がなければ「予約を確定する」ボタンをクリックしてください。"}),(u||g.length>0)&&(0,i.jsxs)("div",{style:{backgroundColor:"#fff3f3",border:"1px solid #d32f2f",borderRadius:"4px",padding:"16px",marginBottom:"20px"},children:[u&&(0,i.jsx)("div",{style:{color:"#d32f2f",fontWeight:"600"},children:u}),g.length>0&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{color:"#d32f2f",fontWeight:"600",marginBottom:"8px"},children:"入力内容をご確認ください："}),(0,i.jsx)("ul",{style:{color:"#d32f2f",margin:"0",paddingLeft:"20px"},children:g.map((e,s)=>(0,i.jsx)("li",{children:e},s))})]})]}),(0,i.jsx)("div",{className:"form-mailer-section",children:(0,i.jsxs)("table",{className:"form-mailer-table",children:[(0,i.jsx)("thead",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("th",{colSpan:2,children:"お客様情報"})})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"お名前"}),(0,i.jsx)("td",{children:r.name})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"フリガナ"}),(0,i.jsx)("td",{children:r.furigana})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"電話番号"}),(0,i.jsx)("td",{children:r.phone})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"性別"}),(0,i.jsx)("td",{children:{male:"男性",female:"女性",other:"その他"}[r.gender]})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"生年月日"}),(0,i.jsx)("td",{children:r.birthDate})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"郵便番号"}),(0,i.jsxs)("td",{children:["〒",r.zipcode]})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"ご住所"}),(0,i.jsx)("td",{children:N})]})]})]})}),m&&(0,i.jsx)("div",{className:"form-mailer-section",children:(0,i.jsxs)("table",{className:"form-mailer-table",children:[(0,i.jsx)("thead",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("th",{colSpan:2,children:"LINE連携情報"})})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"ユーザー名"}),(0,i.jsx)("td",{children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[m.profile.pictureUrl&&(0,i.jsx)("img",{src:m.profile.pictureUrl,alt:"LINE Profile",style:{width:"32px",height:"32px",borderRadius:"50%"}}),(0,i.jsx)("span",{children:m.profile.displayName})]})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"連携状況"}),(0,i.jsx)("td",{children:"✓ LINE認証済み"})]})]})]})}),(0,i.jsx)("div",{className:"form-mailer-section",children:(0,i.jsxs)("table",{className:"form-mailer-table",children:[(0,i.jsxs)("thead",{children:[(0,i.jsx)("tr",{children:(0,i.jsx)("th",{colSpan:b.shouldShowItemPrices()?4:3,children:"ご予約商品"})}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"商品名"}),b.shouldShowQuantity()&&(0,i.jsx)("th",{children:"数量"}),(0,i.jsx)("th",{children:"引き取り日"}),b.shouldShowItemPrices()&&(0,i.jsx)("th",{children:"小計"})]})]}),(0,i.jsx)("tbody",{children:null===(s=r.products)||void 0===s?void 0:s.map((e,s)=>{let r=t.find(s=>s.id===e.productId);return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:null==r?void 0:r.name}),b.shouldShowQuantity()&&(0,i.jsxs)("td",{children:[e.quantity,"個"]}),(0,i.jsx)("td",{children:e.pickupDate}),b.shouldShowItemPrices()&&(0,i.jsxs)("td",{style:{fontWeight:"600"},children:["\xa5",(((null==r?void 0:r.price)||0)*e.quantity).toLocaleString(),b.shouldShowQuantity()&&(0,i.jsxs)("div",{style:{fontSize:"12px",color:"#666666"},children:["\xa5",((null==r?void 0:r.price)||0).toLocaleString()," \xd7 ",e.quantity]})]})]},s)})})]})}),r.comment&&(0,i.jsx)("div",{className:"form-mailer-section",children:(0,i.jsxs)("table",{className:"form-mailer-table",children:[(0,i.jsx)("thead",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("th",{children:"店舗へのコメント"})})}),(0,i.jsx)("tbody",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{children:r.comment})})})]})}),S.length>0&&(0,i.jsx)("div",{className:"form-mailer-section",children:(0,i.jsxs)("table",{className:"form-mailer-table",children:[(0,i.jsx)("thead",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("th",{children:"引き取り予定日"})})}),(0,i.jsx)("tbody",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{children:S.map((e,s)=>(0,i.jsx)("span",{style:{display:"inline-block",margin:"2px 4px 2px 0",padding:"4px 8px",backgroundColor:"#f5f5f5",border:"1px solid #e0e0e0",borderRadius:"4px",fontSize:"14px"},children:e},s))})})})]})}),b.shouldShowTotal()&&(0,i.jsx)("div",{className:"form-mailer-section",children:(0,i.jsxs)("table",{className:"form-mailer-table",children:[(0,i.jsx)("thead",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("th",{colSpan:2,style:{backgroundColor:"#333333",color:"#ffffff",textAlign:"center",fontSize:"16px",fontWeight:"700"},children:"合計金額"})})}),(0,i.jsxs)("tbody",{children:[(0,i.jsx)("tr",{children:(0,i.jsxs)("td",{style:{textAlign:"center",fontSize:"24px",fontWeight:"700",color:"#333333",padding:"20px"},children:["\xa5",v.toLocaleString()]})}),o&&(0,i.jsx)("tr",{children:(0,i.jsx)("td",{style:{textAlign:"center",fontSize:"12px",color:"#666666",fontStyle:"italic"},children:b.getDisplayModeDescription()})})]})]})}),(0,i.jsxs)("div",{style:{marginTop:"30px"},children:[(0,i.jsx)("button",{onClick:w,disabled:x||f||g.length>0,className:"form-mailer-button",style:{backgroundColor:x||f||g.length>0?"#cccccc":"#333333",cursor:x||f||g.length>0?"not-allowed":"pointer"},children:f?"予約確定中...":"予約を確定する"}),(0,i.jsx)("button",{onClick:p,disabled:x||f,className:"form-mailer-button-secondary",style:{marginTop:"10px"},children:"内容を修正する"}),g.length>0&&(0,i.jsx)("div",{style:{backgroundColor:"#fff3cd",border:"1px solid #ffeaa7",borderRadius:"4px",padding:"12px",marginTop:"16px",fontSize:"14px",color:"#856404"},children:"上記のエラーを修正してから予約を確定してください。"})]}),(0,i.jsx)("div",{style:{textAlign:"center",marginTop:"30px",paddingTop:"20px",borderTop:"1px solid #e0e0e0",fontSize:"12px",color:"#666666"},children:"入力された情報は安全に暗号化されて送信されます"})]})})}function h(e){var s;let{reservationData:r,availableProducts:l=[],pricingSettings:t,lineAuthInfo:a,onManage:o,onNewReservation:m,reservationId:h}=e,p=new n(t),x=r?d(r,l):0,u=r?c(r):[];return r&&function(e,s){var r;let i=(null===(r=e.products)||void 0===r?void 0:r.map(e=>{let r=s.find(s=>s.id===e.productId);return"".concat((null==r?void 0:r.name)||"不明な商品"," \xd7 ").concat(e.quantity)}).join(", "))||"商品なし";"".concat(e.name,"様 - ").concat(i)}(r,l),(0,i.jsx)("div",{className:"form-mailer-style",children:(0,i.jsxs)("div",{className:"form-mailer-container",children:[(0,i.jsxs)("div",{className:"form-mailer-progress",children:[(0,i.jsxs)("div",{className:"form-mailer-step",children:[(0,i.jsx)("div",{className:"form-mailer-step-number",children:"1"}),(0,i.jsx)("span",{children:"入力"})]}),(0,i.jsx)("div",{className:"form-mailer-step-arrow",children:"→"}),(0,i.jsxs)("div",{className:"form-mailer-step",children:[(0,i.jsx)("div",{className:"form-mailer-step-number",children:"2"}),(0,i.jsx)("span",{children:"確認"})]}),(0,i.jsx)("div",{className:"form-mailer-step-arrow",children:"→"}),(0,i.jsxs)("div",{className:"form-mailer-step active",children:[(0,i.jsx)("div",{className:"form-mailer-step-number",children:"3"}),(0,i.jsx)("span",{children:"完了"})]})]}),(0,i.jsx)("h1",{className:"form-mailer-title",children:"予約完了"}),(0,i.jsxs)("div",{className:"form-mailer-success",children:[(0,i.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"✓"}),(0,i.jsx)("div",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"8px"},children:"ご予約ありがとうございました"}),(0,i.jsx)("div",{style:{fontSize:"14px"},children:"予約が正常に完了いたしました。"})]}),h&&(0,i.jsx)("div",{className:"form-mailer-section",children:(0,i.jsxs)("table",{className:"form-mailer-table",children:[(0,i.jsx)("thead",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("th",{children:"予約番号"})})}),(0,i.jsxs)("tbody",{children:[(0,i.jsx)("tr",{children:(0,i.jsx)("td",{style:{textAlign:"center",fontSize:"18px",fontWeight:"700",fontFamily:"monospace",color:"#333333",padding:"16px"},children:h})}),(0,i.jsx)("tr",{children:(0,i.jsx)("td",{style:{textAlign:"center",fontSize:"12px",color:"#666666",padding:"8px"},children:"この番号はお問い合わせの際に必要です"})})]})]})}),r&&(0,i.jsx)("div",{className:"form-mailer-section",children:(0,i.jsxs)("table",{className:"form-mailer-table",children:[(0,i.jsx)("thead",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("th",{colSpan:2,children:"ご予約内容"})})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"お名前"}),(0,i.jsx)("td",{children:r.name})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"商品数"}),(0,i.jsxs)("td",{children:[(null===(s=r.products)||void 0===s?void 0:s.length)||0,"点"]})]}),p.shouldShowTotal()&&(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"合計金額"}),(0,i.jsxs)("td",{style:{fontWeight:"600",color:"#333333"},children:["\xa5",x.toLocaleString()]})]}),u.length>0&&(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"引き取り予定日"}),(0,i.jsx)("td",{children:u.map((e,s)=>(0,i.jsx)("span",{style:{display:"inline-block",margin:"2px 4px 2px 0",padding:"4px 8px",backgroundColor:"#e8f5e8",border:"1px solid #4caf50",borderRadius:"4px",fontSize:"14px",color:"#2e7d32"},children:e},s))})]})]})]})}),a&&(0,i.jsx)("div",{className:"form-mailer-section",children:(0,i.jsxs)("table",{className:"form-mailer-table",children:[(0,i.jsx)("thead",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("th",{colSpan:2,children:"LINE連携完了"})})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"ユーザー名"}),(0,i.jsx)("td",{children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.profile.pictureUrl&&(0,i.jsx)("img",{src:a.profile.pictureUrl,alt:"LINE Profile",style:{width:"24px",height:"24px",borderRadius:"50%"}}),(0,i.jsx)("span",{children:a.profile.displayName})]})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"連携状況"}),(0,i.jsx)("td",{children:"✓ 連携完了"})]})]})]})}),(0,i.jsx)("div",{className:"form-mailer-section",children:(0,i.jsxs)("table",{className:"form-mailer-table",children:[(0,i.jsx)("thead",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("th",{children:"お問い合わせ先"})})}),(0,i.jsx)("tbody",{children:(0,i.jsx)("tr",{children:(0,i.jsxs)("td",{style:{textAlign:"center",padding:"20px"},children:[(0,i.jsx)("div",{style:{marginBottom:"12px",color:"#666666"},children:"予約内容の詳細やご質問は、以下までお気軽にお問い合わせください"}),(0,i.jsxs)("div",{style:{padding:"16px",backgroundColor:"#f5f5f5",border:"1px solid #e0e0e0",borderRadius:"4px"},children:[(0,i.jsx)("div",{style:{fontSize:"18px",fontWeight:"700",color:"#333333",marginBottom:"8px"},children:"TEL: 0120-XXX-XXX"}),(0,i.jsx)("div",{style:{fontSize:"14px",color:"#666666"},children:"営業時間：8:30～18:00（定休日：毎週水曜）"})]})]})})})]})}),(0,i.jsxs)("div",{style:{marginTop:"30px"},children:[(0,i.jsx)("button",{onClick:o,className:"form-mailer-button-secondary",style:{marginBottom:"10px"},children:"予約を変更・キャンセル"}),(0,i.jsx)("button",{onClick:m,className:"form-mailer-button",children:"新しい予約をする"})]}),(0,i.jsxs)("div",{className:"form-mailer-info",style:{marginTop:"30px"},children:[(0,i.jsx)("strong",{children:"ご注意事項"}),(0,i.jsx)("br",{}),"• 予約の変更・キャンセルは引き取り日の前日までにお願いします",(0,i.jsx)("br",{}),"• 当日の変更・キャンセルはお電話にてご連絡ください",(0,i.jsx)("br",{}),"• 商品の準備状況により、お引き取り時間が前後する場合があります"]}),(0,i.jsx)("div",{style:{textAlign:"center",marginTop:"30px",paddingTop:"20px",borderTop:"1px solid #e0e0e0",fontSize:"12px",color:"#666666"}})]})})}function p(e){let{reservationData:s,onBack:r}=e;return(0,i.jsx)("div",{className:"form-mailer-container",children:(0,i.jsxs)("div",{className:"form-mailer-section",children:[(0,i.jsx)("h2",{className:"form-mailer-title",children:"予約の変更・キャンセル"}),(0,i.jsx)("div",{className:"alert alert-warning mb-4",children:(0,i.jsxs)("div",{className:"d-flex align-items-center",children:[(0,i.jsx)("i",{className:"bi bi-exclamation-triangle-fill me-2"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h5",{className:"alert-heading mb-2",children:"予約の変更・キャンセルについて"}),(0,i.jsxs)("p",{className:"mb-0",children:["予約の変更・キャンセルをご希望の場合は、",(0,i.jsx)("br",{}),"お電話にてお問い合わせください。"]})]})]})}),s&&(0,i.jsxs)("div",{className:"form-mailer-section",children:[(0,i.jsx)("h3",{className:"h5 fw-semibold text-dark mb-3",children:"現在の予約情報"}),(0,i.jsx)("div",{className:"card",children:(0,i.jsx)("div",{className:"card-body",children:(0,i.jsx)("table",{className:"form-mailer-table",children:(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"お名前"}),(0,i.jsx)("td",{children:s.name})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"電話番号"}),(0,i.jsx)("td",{children:s.phone})]})]})})})})]}),(0,i.jsx)("div",{className:"alert alert-info mb-4",children:(0,i.jsxs)("div",{className:"d-flex align-items-center",children:[(0,i.jsx)("i",{className:"bi bi-telephone-fill me-2"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h5",{className:"alert-heading mb-2",children:"お問い合わせ先"}),(0,i.jsx)("p",{className:"h4 fw-bold mb-2",children:"TEL: 0120-XXX-XXX"}),(0,i.jsx)("p",{className:"mb-0",children:"営業時間: 9:00-18:00（土日祝除く）"})]})]})}),(0,i.jsxs)("div",{className:"d-grid gap-3",children:[(0,i.jsxs)("button",{onClick:()=>{window.location.href="tel:0120-XXX-XXX"},className:"form-mailer-button",type:"button",children:[(0,i.jsx)("i",{className:"bi bi-telephone me-2"}),"電話でお問い合わせ"]}),(0,i.jsxs)("button",{onClick:r,className:"form-mailer-button form-mailer-button-secondary",type:"button",children:[(0,i.jsx)("i",{className:"bi bi-arrow-left me-2"}),"前の画面に戻る"]})]})]})})}let x=[{id:"tomato",name:"トマトの苗",price:200},{id:"cucumber",name:"きゅうりの苗",price:180},{id:"eggplant",name:"なすの苗",price:220},{id:"pepper",name:"ピーマンの苗",price:190},{id:"lettuce",name:"レタスの種",price:150},{id:"carrot",name:"にんじんの種",price:120},{id:"radish",name:"だいこんの種",price:100},{id:"spinach",name:"ほうれん草の種",price:130}];function u(e){let{pricingSettings:s,lineAuthInfo:r}=e,[a,n]=(0,l.useState)("form"),[c,d]=(0,l.useState)(null),[u,f]=(0,l.useState)([{productId:"",quantity:1,pickupDate:""}]),[j,g]=(0,l.useState)({name:"",furigana:"",phone:"",zipcode:"",prefecture:"",city:"",town:"",addressDetail:"",gender:"male",birthDate:""}),[y,b]=(0,l.useState)(""),[v,N]=(0,l.useState)({}),S=()=>{let e={};j.name||(e.name="名前を入力してください"),j.phone||(e.phone="電話番号を入力してください"),(0===u.length||u.every(e=>!e.productId))&&(e.products="最低1つの商品を選択してください");let s=new Date().toISOString().split("T")[0];return u.some(e=>e.pickupDate<s)&&(e.pickupDate="引き取り日は今日以降の日付を選択してください"),N(e),0===Object.keys(e).length};switch(a){case"form":default:return(0,i.jsx)("div",{className:"form-mailer-style",children:(0,i.jsxs)("div",{className:"form-mailer-container",children:[(0,i.jsxs)("div",{className:"form-mailer-progress",children:[(0,i.jsxs)("div",{className:"form-mailer-step active",children:[(0,i.jsx)("div",{className:"form-mailer-step-number",children:"1"}),(0,i.jsx)("span",{children:"入力"})]}),(0,i.jsx)("div",{className:"form-mailer-step-arrow",children:"→"}),(0,i.jsxs)("div",{className:"form-mailer-step",children:[(0,i.jsx)("div",{className:"form-mailer-step-number",children:"2"}),(0,i.jsx)("span",{children:"確認"})]}),(0,i.jsx)("div",{className:"form-mailer-step-arrow",children:"→"}),(0,i.jsxs)("div",{className:"form-mailer-step",children:[(0,i.jsx)("div",{className:"form-mailer-step-number",children:"3"}),(0,i.jsx)("span",{children:"完了"})]})]}),(0,i.jsx)("h1",{className:"form-mailer-title",children:"予約フォーム"}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),S()&&(d({...j,products:u,comment:y}),n("confirm"))},children:[(0,i.jsx)(t,{formData:j,setFormData:g,errors:v}),(0,i.jsx)(o,{productItems:u,setProductItems:f,availableProducts:x,pricingSettings:s,errors:v}),(0,i.jsxs)("div",{className:"form-mailer-section",children:[(0,i.jsx)("label",{className:"form-mailer-label",children:"店舗へのコメント"}),(0,i.jsx)("textarea",{value:y,onChange:e=>b(e.target.value),className:"form-mailer-textarea",rows:4,placeholder:"ご要望やご質問がございましたらご記入ください（500文字以内）"}),v.comment&&(0,i.jsx)("span",{className:"form-mailer-error",children:v.comment})]}),(0,i.jsx)("button",{type:"submit",className:"form-mailer-button",children:"入力内容を確認する"})]})]})});case"confirm":return(0,i.jsx)(m,{reservationData:c,availableProducts:x,pricingSettings:s,lineAuthInfo:r,onConfirm:()=>{n("complete")},onEdit:()=>{n("form")}});case"complete":return(0,i.jsx)(h,{reservationData:c||void 0,availableProducts:x,pricingSettings:s,lineAuthInfo:r,onManage:()=>n("manage"),onNewReservation:()=>{g({name:"",furigana:"",phone:"",zipcode:"",prefecture:"",city:"",town:"",addressDetail:"",gender:"male",birthDate:""}),b(""),d(null),f([{productId:"",quantity:1,pickupDate:""}]),N({}),n("form")},reservationId:"RES-".concat(Date.now().toString())});case"manage":return(0,i.jsx)(p,{reservationData:c,onBack:()=>n("complete")})}}function f(){return(0,i.jsx)("div",{className:"min-h-screen py-8",children:(0,i.jsxs)("div",{className:"container mx-auto px-4",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-center text-gray-800 mb-8",children:"ベジライス予約システム"}),(0,i.jsx)(u,{})]})})}}},function(e){e.O(0,[362,744],function(){return e(e.s=7618)}),_N_E=e.O()}]);