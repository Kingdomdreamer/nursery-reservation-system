"use strict";exports.id=871,exports.ids=[871],exports.modules={8871:(e,s,t)=>{t.d(s,{Z:()=>c});var r=t(326),a=t(7577);async function l(e){try{let s=await fetch(`https://zipcloud.ibsnet.co.jp/api/search?zipcode=${e}`),t=await s.json();if(200===t.status&&t.results&&t.results.length>0){let e=t.results[0];return{prefecture:e.address1,city:e.address2,town:e.address3,fullAddress:`${e.address1}${e.address2}${e.address3}`}}return null}catch(e){return null}}var d=t(3084);function c({formConfig:e,liffProfile:s,isLiffReady:t}){let[c,n]=(0,a.useState)({}),[i,o]=(0,a.useState)(new Set),[u,x]=(0,a.useState)(!1),[m,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),y=e=>s=>{n({...c,[e]:s.target.value})},b=e=>{let s=function(e){let s=e.replace(/[^0-9]/g,"");return s.length<=3?s:`${s.slice(0,3)}-${s.slice(3,7)}`}(e.target.value);n({...c,postal_code:s}),s.replace(/[^0-9]/g,"").length<7&&i.size>0&&(n(e=>({...e,prefecture:"",city:"",address:""})),o(new Set))},f=async()=>{let e=(c.postal_code||"").replace(/[^0-9]/g,"");if(7===e.length){x(!0);try{let s=await l(e);s&&(n(e=>({...e,prefecture:s.prefecture||"",city:s.city||"",address:s.town||""})),o(new Set(["prefecture","city"])))}catch(e){}finally{x(!1)}}},j=()=>{n(e=>({...e,prefecture:"",city:"",address:""})),o(new Set)},N=e=>i.has(e)&&("prefecture"===e||"city"===e)?"w-full px-3 py-2 border border-green-300 bg-green-50 rounded-md text-sm":"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",v=e=>i.has(e)&&("prefecture"===e||"city"===e),w=()=>{let e=(c.postal_code||"").replace(/[^0-9]/g,"");return 0===e.length?"郵便番号を入力してください":e.length<7?`あと${7-e.length}桁入力してください`:7===e.length?"タップして住所を検索":""},_=e.fields.filter(e=>!1!==e.enabled),C=async()=>{if(!m){p(!0),g(null);try{let e=_.filter(e=>e.required).filter(e=>!c[e.id]?.trim());if(e.length>0){g(`必須項目が未入力です: ${e.map(e=>e.label).join(", ")}`);return}let r={name:c.customer_name||c.name||c.full_name||"",furigana:c.customer_furigana||c.furigana||"",email:c.customer_email||c.email||"",phone:c.customer_phone||c.phone||"",postal_code:c.postal_code||"",prefecture:c.prefecture||"",city:c.city||"",address:c.address||"",birth_date:c.customer_birth_date||c.birth_date||"",gender:c.customer_gender||c.gender||""};if(s?.userId&&t)try{await d.r.autoLinkExistingCustomer(s.userId,{userId:s.userId,displayName:s.displayName||"",pictureUrl:s.pictureUrl,statusMessage:s.statusMessage},r)}catch(e){}alert("予約が完了しました！")}catch(e){g("予約処理中にエラーが発生しました。もう一度お試しください。")}finally{p(!1)}}};return(0,r.jsxs)("div",{className:"max-w-lg mx-auto bg-white border rounded-lg p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:e.name}),r.jsx("p",{className:"text-gray-600 text-sm",children:e.description})]}),(0,r.jsxs)("form",{className:"space-y-6",children:[_.map(e=>{let s=c[e.id]||"";return"postal_code"===e.id?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e.label,e.required&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"}),u&&r.jsx("span",{className:"text-sm text-blue-600 ml-2",children:"住所を検索中..."})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("input",{type:"text",value:s,onChange:b,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:e.placeholder||"例: 123-4567",maxLength:8}),r.jsx("button",{type:"button",onClick:f,disabled:u||7!==s.replace(/[^0-9]/g,"").length,title:w(),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${u||7!==s.replace(/[^0-9]/g,"").length?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:u?"検索中...":"住所検索"}),i.size>0&&r.jsx("button",{type:"button",onClick:j,className:"px-3 py-2 text-sm bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"クリア"})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[r.jsx("p",{children:"\uD83D\uDCCD 郵便番号を7桁入力後、「住所検索」ボタンをタップで住所が自動入力されます"}),r.jsx("p",{children:"\uD83D\uDD12 都道府県・市区町村は自動入力、町名以降は編集できます"})]})]},e.id):"prefecture"===e.id||"city"===e.id?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e.label,e.required&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"}),i.has(e.id)&&r.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"(自動入力)"})]}),r.jsx("input",{type:"text",value:s,onChange:y(e.id),className:N(e.id),placeholder:e.placeholder,readOnly:v(e.id)})]},e.id):(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[e.label,e.required&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),"textarea"===e.type?r.jsx("textarea",{value:s,onChange:y(e.id),placeholder:e.placeholder,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3}):"select"===e.type?(0,r.jsxs)("select",{value:s,onChange:y(e.id),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"選択してください"}),e.options?.map((e,s)=>r.jsx("option",{value:e,children:e},s))]}):"radio"===e.type?r.jsx("div",{className:"space-y-2",children:e.options?.map((t,a)=>r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"radio",name:e.id,value:t,checked:s===t,onChange:y(e.id),className:"mr-2"}),t]},a))}):"checkbox"===e.type?r.jsx("div",{className:"space-y-2",children:e.options?.map((e,s)=>r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",value:e,className:"mr-2"}),e]},s))}):r.jsx("input",{type:e.type,value:s,onChange:y(e.id),placeholder:e.placeholder,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]},e.id)}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"商品選択"}),r.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:r.jsx("p",{className:"text-sm text-gray-600",children:"選択された商品がここに表示されます"})})]}),r.jsx("div",{className:"text-right",children:(0,r.jsxs)("div",{className:"text-lg font-semibold",children:[r.jsx("span",{className:"text-gray-600",children:"小計: "}),r.jsx("span",{className:"text-gray-900",children:"\xa50"})]})})]}),h&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("span",{className:"text-red-400",children:"⚠️"})}),r.jsx("div",{className:"ml-3",children:r.jsx("p",{className:"text-sm text-red-700",children:h})})]})}),r.jsx("button",{type:"button",onClick:C,disabled:m,className:`w-full py-3 px-4 rounded-lg font-medium transition-colors ${m?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:m?"送信中...":"予約内容を確認する"})]}),r.jsx("div",{className:"text-center text-xs text-gray-500",children:"※ これはプレビューです。実際の予約はできません。"})]})}}};