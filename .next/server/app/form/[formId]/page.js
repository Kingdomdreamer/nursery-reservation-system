(()=>{var e={};e.id=978,e.ids=[978],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8893:e=>{"use strict";e.exports=require("buffer")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8216:e=>{"use strict";e.exports=require("net")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},8563:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.Z,__next_app__:()=>d,originalPathname:()=>c,pages:()=>u,routeModule:()=>m,tree:()=>l}),r(3190),r(4129),r(6083),r(5866);var s=r(3191),i=r(8716),a=r(8001),n=r(5231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);r.d(t,o);let l=["",{children:["form",{children:["[formId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,3190)),"/mnt/c/Claude/インストール/nursery-reservation-system/app/form/[formId]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,4129)),"/mnt/c/Claude/インストール/nursery-reservation-system/app/layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,6083)),"/mnt/c/Claude/インストール/nursery-reservation-system/app/error.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],u=["/mnt/c/Claude/インストール/nursery-reservation-system/app/form/[formId]/page.tsx"],c="/form/[formId]/page",d={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/form/[formId]/page",pathname:"/form/[formId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},7545:(e,t,r)=>{Promise.resolve().then(r.bind(r,9329))},9329:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(326),i=r(7577),a=r(5047);r(5442);var n=r(8871),o=r(888),l=r(8602);function u(){(0,a.useParams)().formId;let[e,t]=(0,i.useState)(null),[r,u]=(0,i.useState)(!0),[c,d]=(0,i.useState)(null),[m,h]=(0,i.useState)(!1),{isLiffReady:x,isInLineApp:p,profile:g,liff:f}=(0,l.a0)();return r?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx(o.JO,{icon:o.PJ.loading,size:"xl",className:"animate-spin text-blue-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"フォームを読み込み中..."})]})}):c?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[s.jsx(o.JO,{icon:o.PJ.error,size:"xl",className:"text-red-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"アクセスできません"}),s.jsx("p",{className:"text-gray-600 mb-4",children:c}),s.jsx("button",{onClick:()=>window.history.back(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"戻る"})]})}):e?(0,s.jsxs)("div",{className:`min-h-screen ${m?"bg-white":"bg-gray-50"}`,children:[!m&&s.jsx("div",{className:"bg-white border-b border-gray-200",children:s.jsx("div",{className:"max-w-lg mx-auto px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx(o.JO,{icon:o.PJ.plant,size:"lg",className:"text-green-600"}),(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:e.settings.businessName||"ベジライス予約システム"}),s.jsx("p",{className:"text-sm text-gray-600",children:"予約フォーム"})]})]})})}),!1,s.jsx("div",{className:`${m?"p-0":"p-4"}`,children:s.jsx("div",{className:`${m?"":"max-w-lg mx-auto"}`,children:s.jsx(n.Z,{formConfig:{...e,products:e.products,pricingSettings:e.pricingSettings},liffProfile:g,isLiffReady:x})})}),!m&&s.jsx("div",{className:"bg-white border-t border-gray-200 mt-8",children:s.jsx("div",{className:"max-w-lg mx-auto px-4 py-6 text-center",children:(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Powered by ",e.settings.businessName||"ベジライス予約システム"]})})})]}):s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[s.jsx(o.JO,{icon:o.PJ.warning,size:"xl",className:"text-yellow-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"フォームが見つかりません"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"指定されたフォームは存在しないか、無効になっています。"}),s.jsx("button",{onClick:()=>window.history.back(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"戻る"})]})})}},5047:(e,t,r)=>{"use strict";var s=r(7389);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}})},3084:(e,t,r)=>{"use strict";r.d(t,{r:()=>i});var s=r(5442);class i{static async linkLineAuthToCustomer(e,t,r){try{let s=await this.findCustomerByLineId(e);if(s)return await this.updateCustomerWithLineAuth(s,t,r);return await this.createCustomerWithLineAuth(e,t,r)}catch(e){throw e}}static async findCustomerByLineId(e){try{let{data:t,error:r}=await s.O.from("customers").select("*").eq("line_user_id",e).single();if(r&&"PGRST116"!==r.code)throw r;return t||null}catch(e){return null}}static async findCustomerByEmail(e){try{let{data:t,error:r}=await s.O.from("customers").select("*").eq("email",e).single();if(r&&"PGRST116"!==r.code)throw r;return t||null}catch(e){return null}}static async findCustomerByPhone(e){try{let{data:t,error:r}=await s.O.from("customers").select("*").eq("phone",e).single();if(r&&"PGRST116"!==r.code)throw r;return t||null}catch(e){return null}}static async updateCustomerWithLineAuth(e,t,r){try{let i={...e,...r,line_user_id:t.userId,updated_at:new Date().toISOString()},{data:a,error:n}=await s.O.from("customers").update(i).eq("id",e.id).select().single();if(n)throw n;return a}catch(e){throw e}}static async createCustomerWithLineAuth(e,t,r){try{let i={...r,line_user_id:e,name:r.name||t.displayName,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:a,error:n}=await s.O.from("customers").insert([i]).select().single();if(n)throw n;return a}catch(e){throw e}}static async autoLinkExistingCustomer(e,t,r){try{if(r.email){let e=await this.findCustomerByEmail(r.email);if(e)return await this.updateCustomerWithLineAuth(e,t,r)}if(r.phone){let e=await this.findCustomerByPhone(r.phone);if(e)return await this.updateCustomerWithLineAuth(e,t,r)}return await this.createCustomerWithLineAuth(e,t,r)}catch(e){throw e}}static async unlinkLineAuth(e){try{let{error:t}=await s.O.from("customers").update({line_user_id:null,updated_at:new Date().toISOString()}).eq("id",e);if(t)throw t}catch(e){throw e}}static async getCustomerLineAuthStatus(e){try{let{data:t,error:r}=await s.O.from("customers").select("line_user_id").eq("id",e).single();if(r)throw r;return{isLinked:!!t.line_user_id,lineUserId:t.line_user_id}}catch(e){return{isLinked:!1}}}static async getLineAuthenticatedCustomers(){try{let{data:e,error:t}=await s.O.from("customers").select("*").not("line_user_id","is",null).order("created_at",{ascending:!1});if(t)throw t;return e||[]}catch(e){return[]}}}},3190:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`/mnt/c/Claude/インストール/nursery-reservation-system/app/form/[formId]/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[431,290,871],()=>r(8563));module.exports=s})();